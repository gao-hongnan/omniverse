

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Type Safety &#8212; Omniverse</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'computer_science/type_theory/02-type-safety';</script>
    <link rel="canonical" href="https://www.gaohongnan.com/computer_science/type_theory/02-type-safety.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Subsumption" href="03-subsumption.html" />
    <link rel="prev" title="Subtypes" href="01-subtypes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Omniverse - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Omniverse - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Transformers - Attention is All You Need</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../transformer/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transformer/notations.html">Notations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transformer/concept.html">Concept</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Software Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../software_engineering/devops/continuous-integration/styling.html">Styling, Formatting, and Linting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software_engineering/design_patterns/dependency-inversion-principle.html">Dependency Inversion Principle</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Structures and Algorithms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/complexity_analysis/intro.html">Complexity Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/complexity_analysis/master_theorem.html">Master Theorem </a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/stack/intro.html">Stack</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/stack/concept.html">Concept</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/searching_algorithms/linear_search/intro.html">Linear Search</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/searching_algorithms/linear_search/concept.html">Concept</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/searching_algorithms/binary_search/intro.html">Binary Search</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/searching_algorithms/binary_search/concept.html">Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/searching_algorithms/binary_search/problems/875-koko-eating-bananas.html">Koko Eating Bananas</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Algebra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../linear_algebra/01_preliminaries/intro.html">Preliminaries</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/01_preliminaries/01-fields.html">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/01_preliminaries/02-systems-of-linear-equations.html">Systems of Linear Equations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../linear_algebra/02_vectors/intro.html">Vectors</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/01-vector-definition.html">Vector and Its Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/02-vector-operation.html">Vector and Its Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/03-vector-norm.html">Vector Norm and Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/04-vector-products.html">A First Look at Vector Products</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Science</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Type Theory, A Very Rudimentary Introduction</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01-subtypes.html">Subtypes</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Type Safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-subsumption.html">Subsumption</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-generics.html">Generics and Type Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-typevar-bound-constraints.html">Bound and Constraint in Generics and Type Variables</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References, Resources and Roadmap</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/computer_science/type_theory/02-type-safety.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Type Safety</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Type Safety</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-type-safe-example">A Type Safe Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#violating-type-safety">Violating Type Safety</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-violation-of-type-safety">Further Violation of Type Safety</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references-and-further-readings">References and Further Readings</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="type-safety">
<h1>Type Safety<a class="headerlink" href="#type-safety" title="Permalink to this heading">#</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id4">Type Safety</a></p></li>
<li><p><a class="reference internal" href="#a-type-safe-example" id="id5">A Type Safe Example</a></p></li>
<li><p><a class="reference internal" href="#violating-type-safety" id="id6">Violating Type Safety</a></p></li>
<li><p><a class="reference internal" href="#further-violation-of-type-safety" id="id7">Further Violation of Type Safety</a></p></li>
<li><p><a class="reference internal" href="#references-and-further-readings" id="id8">References and Further Readings</a></p></li>
</ul>
</nav>
<section id="id1">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Type Safety</a><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>A subtype is a foundational concept in type theory and object-oriented
programming that facilitates type safety and polymorphism. The relationship
between a subtype <span class="math notranslate nohighlight">\(S\)</span> and a supertype <span class="math notranslate nohighlight">\(T\)</span> is denoted as <span class="math notranslate nohighlight">\(S &lt;: T\)</span>,
<span class="math notranslate nohighlight">\(S \subseteq T\)</span>, or <span class="math notranslate nohighlight">\(S ≤: T\)</span>. Before we detail the
<strong><em>criterion</em></strong><a class="footnote-reference brackets" href="#what-is-a-criterion" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> for subtype in the next section, we state
an important implication of subtype - type safety.</p>
<div class="proof definition admonition" id="type-theory-subtype-and-type-safety">
<p class="admonition-title"><span class="caption-number">Definition 18 </span> (Subtype and Type Safety)</p>
<section class="definition-content" id="proof-content">
<p>If <span class="math notranslate nohighlight">\(S\)</span> is a subtype of <span class="math notranslate nohighlight">\(T\)</span>, the subtyping
<a class="reference external" href="https://en.wikipedia.org/wiki/Relation_(mathematics)">relation</a> (written as
<span class="math notranslate nohighlight">\(S &lt;: T\)</span>, <span class="math notranslate nohighlight">\(S \subseteq T\)</span>, or <span class="math notranslate nohighlight">\(S \leq: T\)</span> ) means that any term of <strong>type</strong> <span class="math notranslate nohighlight">\(S\)</span> can
<strong>safely</strong> be used in any <strong>context</strong> where a term of <strong>type</strong> <span class="math notranslate nohighlight">\(T\)</span> is
<strong>expected</strong>.</p>
</section>
</div><p>In other words, we say that <span class="math notranslate nohighlight">\(S\)</span> is a <strong><em>subtype</em></strong> of <span class="math notranslate nohighlight">\(T\)</span> <strong><em>if a piece of code
written for variables of type</em></strong> <span class="math notranslate nohighlight">\(T\)</span> <strong><em>can also safely be used on variables of
type</em></strong> <span class="math notranslate nohighlight">\(S\)</span> <a class="footnote-reference brackets" href="#cs2040s-variable-and-type" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<p>What does this mean?</p>
<p>This means that if <span class="math notranslate nohighlight">\(S\)</span> is a subtype of <span class="math notranslate nohighlight">\(T\)</span>, you can use an instance of <span class="math notranslate nohighlight">\(S\)</span> in
any place where an instance of <span class="math notranslate nohighlight">\(T\)</span> is required, without any issues related to
type compatibility. That is what we call <strong>subtype polymorphism</strong>.</p>
<p>This concept of subtyping forms the basis of subtype polymorphism in
object-oriented programming. Subtype polymorphism allows objects of a subtype to
be treated as objects of a supertype, enabling methods to operate on objects of
different types as long as they share a common supertype. This mechanism is
critical for implementing interfaces and abstract classes in a type-safe manner.</p>
<p>More formally, in subtype polymorphism, if <span class="math notranslate nohighlight">\(S\)</span> is a subtype of <span class="math notranslate nohighlight">\(T\)</span> (denoted as
<span class="math notranslate nohighlight">\(S &lt;: T\)</span>), then objects of type <span class="math notranslate nohighlight">\(S\)</span> can be used in contexts expecting objects of
type <span class="math notranslate nohighlight">\(T\)</span>. This interoperability is guaranteed without loss of integrity or
behavior of the original type <span class="math notranslate nohighlight">\(S\)</span>, ensuring that operations performed on <span class="math notranslate nohighlight">\(T\)</span> are
valid on <span class="math notranslate nohighlight">\(S\)</span>. This allows for greater flexibility and code reuse while
maintaining strict type safety, as it ensures that the substitutability of
subtypes for their supertypes does not lead to runtime type errors or unexpected
behaviors.</p>
</section>
<section id="a-type-safe-example">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">A Type Safe Example</a><a class="headerlink" href="#a-type-safe-example" title="Permalink to this heading">#</a></h2>
<p>Assume for a moment that the class <code class="docutils literal notranslate"><span class="pre">Cat</span></code> and <code class="docutils literal notranslate"><span class="pre">Dog</span></code> are both valid <em>subtype</em> of
the class <code class="docutils literal notranslate"><span class="pre">Animal</span></code> through class inheritance, which we have learned earlier to
be called <a class="reference internal" href="01-subtypes.html"><span class="doc std std-doc"><strong>nominal subtyping</strong></span></a> (i.e.
subclasses are subtypes).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">Animal</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 3</span>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">make_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 6</span>        <span class="k">return</span> <span class="s2">&quot;Generic Animal Sound!&quot;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
<span class="linenos">10</span>    <span class="k">def</span> <span class="nf">make_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">11</span>        <span class="k">return</span> <span class="s2">&quot;Woof!&quot;</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="k">def</span> <span class="nf">fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">14</span>        <span class="k">return</span> <span class="s2">&quot;Happily fetching balls!&quot;</span>
<span class="linenos">15</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
<span class="linenos">18</span>    <span class="k">def</span> <span class="nf">make_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">19</span>        <span class="k">return</span> <span class="s2">&quot;Meow&quot;</span>
<span class="linenos">20</span>
<span class="linenos">21</span>    <span class="k">def</span> <span class="nf">how_many_lives</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">22</span>        <span class="k">return</span> <span class="s2">&quot;I have 9 lives!&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Then this means that <em>any instance of <code class="docutils literal notranslate"><span class="pre">Dog</span></code> or <code class="docutils literal notranslate"><span class="pre">Cat</span></code> can safely be used in a
context where an instance of <code class="docutils literal notranslate"><span class="pre">Animal</span></code> is expected</em>.</p>
<p>For example, consider the following function <code class="docutils literal notranslate"><span class="pre">describe_animal</span></code> that takes in an
<code class="docutils literal notranslate"><span class="pre">animal</span></code> of type <code class="docutils literal notranslate"><span class="pre">Animal</span></code>. This is telling developers that we can pass in any
animal as long as it is a subtype of the <code class="docutils literal notranslate"><span class="pre">Animal</span></code> class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">def</span> <span class="nf">describe_animal</span><span class="p">(</span><span class="n">animal</span><span class="p">:</span> <span class="n">Animal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="k">return</span> <span class="n">animal</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; makes sound &quot;</span> <span class="o">+</span> <span class="n">animal</span><span class="o">.</span><span class="n">make_sound</span><span class="p">()</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">generic_animal</span> <span class="o">=</span> <span class="n">Animal</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="n">generic_animal_sound</span> <span class="o">=</span> <span class="n">describe_animal</span><span class="p">(</span><span class="n">generic_animal</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="nb">print</span><span class="p">(</span><span class="n">generic_animal_sound</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">generic_dog</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">()</span>
<span class="linenos"> 9</span><span class="n">generic_dog_sound</span> <span class="o">=</span> <span class="n">describe_animal</span><span class="p">(</span><span class="n">generic_dog</span><span class="p">)</span>
<span class="linenos">10</span><span class="nb">print</span><span class="p">(</span><span class="n">generic_dog_sound</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">generic_cat</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">()</span>
<span class="linenos">13</span><span class="n">generic_cat_sound</span> <span class="o">=</span> <span class="n">describe_animal</span><span class="p">(</span><span class="n">generic_cat</span><span class="p">)</span>
<span class="linenos">14</span><span class="nb">print</span><span class="p">(</span><span class="n">generic_cat_sound</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Animal makes sound Generic Animal Sound!
Dog makes sound Woof!
Cat makes sound Meow
</pre></div>
</div>
</div>
</div>
<p>In fact, what we have described is also inherently related with variable
assignment. You can also think of variable assigning from the function
<code class="docutils literal notranslate"><span class="pre">describe_animal</span></code> above. How so? When you pass in an instance of <code class="docutils literal notranslate"><span class="pre">Dog</span></code>, say
<code class="docutils literal notranslate"><span class="pre">generic_dog</span></code>, to the function <code class="docutils literal notranslate"><span class="pre">describe_animal</span></code>, you are essentially assigning
<code class="docutils literal notranslate"><span class="pre">generic_dog</span></code> to the parameter/variable <code class="docutils literal notranslate"><span class="pre">animal</span></code> in the function.</p>
<p>By <em>extension</em>, the following assignment:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">generic_animal</span> <span class="o">=</span> <span class="n">generic_dog</span>  <span class="c1"># Safe because Dog &lt;: Animal</span>
</pre></div>
</div>
</div>
</div>
<p>is allowed and considered safe because we are substituting (assigning) an
<strong>expression</strong> <code class="docutils literal notranslate"><span class="pre">generic_dog</span></code> of type instance <code class="docutils literal notranslate"><span class="pre">Dog</span></code> to the <strong>variable</strong>
<code class="docutils literal notranslate"><span class="pre">generic_animal</span></code> is allowed because we established that <code class="docutils literal notranslate"><span class="pre">Dog</span></code> is a subtype of
<code class="docutils literal notranslate"><span class="pre">Animal</span></code> - so it is safe. A static type checker such as <code class="docutils literal notranslate"><span class="pre">mypy</span></code> will not raise an
error here. However, if you were to do the reverse:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">generic_dog</span> <span class="o">=</span> <span class="n">generic_animal</span>  <span class="c1"># Unsafe because Animal is not a subtype of Dog</span>
</pre></div>
</div>
</div>
</div>
<p>Then the static type checker will raise an error:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">error</span><span class="p">:</span> <span class="n">Incompatible</span> <span class="n">types</span> <span class="ow">in</span> <span class="n">assignment</span> <span class="p">(</span><span class="n">expression</span> <span class="n">has</span> <span class="nb">type</span> <span class="s2">&quot;Animal&quot;</span><span class="p">,</span> <span class="n">variable</span> <span class="n">has</span> <span class="nb">type</span> <span class="s2">&quot;Dog&quot;</span><span class="p">)</span>  <span class="p">[</span><span class="n">assignment</span><span class="p">]</span>
    <span class="n">generic_dog</span> <span class="o">=</span> <span class="n">generic_animal</span>
</pre></div>
</div>
<p>indicating that you are trying to assign an expression <code class="docutils literal notranslate"><span class="pre">generic_animal</span></code> of type
<code class="docutils literal notranslate"><span class="pre">Animal</span></code> to the variable <code class="docutils literal notranslate"><span class="pre">generic_dog</span></code> of type <code class="docutils literal notranslate"><span class="pre">Dog</span></code>. This is unsafe because
there is no guarantee that the <code class="docutils literal notranslate"><span class="pre">Animal</span></code> class has say, all methods that a <code class="docutils literal notranslate"><span class="pre">Dog</span></code>
instance might have!</p>
<p>In short, we have:</p>
<blockquote>
<div><p>Therefore, it’s safe to assign an instance of <code class="docutils literal notranslate"><span class="pre">Dog</span></code> to a variable of type
<code class="docutils literal notranslate"><span class="pre">Animal</span></code> since <code class="docutils literal notranslate"><span class="pre">Dog</span></code> contains all functionalities (<code class="docutils literal notranslate"><span class="pre">make_sound</span></code>) of <code class="docutils literal notranslate"><span class="pre">Animal</span></code>
and possibly more (<code class="docutils literal notranslate"><span class="pre">fetch</span></code>) so there won’t be any surprise here. But it is
deemed unsafe to assign <code class="docutils literal notranslate"><span class="pre">generic_animal</span></code> to <code class="docutils literal notranslate"><span class="pre">generic_dog</span></code> because not every
<code class="docutils literal notranslate"><span class="pre">Animal</span></code> is a <code class="docutils literal notranslate"><span class="pre">Dog</span></code>. While every <code class="docutils literal notranslate"><span class="pre">Dog</span></code> instance is an <code class="docutils literal notranslate"><span class="pre">Animal</span></code> (fulfilling the
subtype criteria), the reverse isn’t true. An <code class="docutils literal notranslate"><span class="pre">Animal</span></code> instance might not have
all functionalities of a <code class="docutils literal notranslate"><span class="pre">Dog</span></code> (like <code class="docutils literal notranslate"><span class="pre">fetch()</span></code>), leading to potential errors
or undefined behaviors if treated as a <code class="docutils literal notranslate"><span class="pre">Dog</span></code>. This violates the principle that
the subtype should be able to handle everything the supertype can, plus
potentially more.</p>
</div></blockquote>
</section>
<section id="violating-type-safety">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Violating Type Safety</a><a class="headerlink" href="#violating-type-safety" title="Permalink to this heading">#</a></h2>
<p>Consider one example that violates type safety:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">Robot</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 3</span>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">make_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="linenos"> 6</span>        <span class="k">return</span> <span class="mi">1</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">robot</span> <span class="o">=</span> <span class="n">Robot</span><span class="p">()</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="k">try</span><span class="p">:</span>
<span class="linenos">11</span>    <span class="n">robot_sound</span> <span class="o">=</span> <span class="n">describe_animal</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>
<span class="linenos">12</span>    <span class="nb">print</span><span class="p">(</span><span class="n">robot_sound</span><span class="p">)</span>
<span class="linenos">13</span><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="linenos">14</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: can only concatenate str (not &quot;int&quot;) to str
</pre></div>
</div>
</div>
</div>
<p>In python there is no notion of type checking during <strong>compile</strong> time unless you
have a static type checker. Consequently, the above code will only throw an
error during <strong>runtime</strong> because we are adding an integer <code class="docutils literal notranslate"><span class="pre">1</span></code> to the string
<code class="docutils literal notranslate"><span class="pre">animal.describe()</span> <span class="pre">+</span> <span class="pre">&quot;</span> <span class="pre">makes</span> <span class="pre">sound</span> <span class="pre">&quot;</span></code>. This is because we are errorneously
passing in an instance of <code class="docutils literal notranslate"><span class="pre">Robot</span></code> to a function that accepts <code class="docutils literal notranslate"><span class="pre">Animal</span></code> only.
Since <code class="docutils literal notranslate"><span class="pre">Robot</span></code> is not a subtype of <code class="docutils literal notranslate"><span class="pre">Animal</span></code>, there is no type safety guarantee.
This example can be way worse if we were to just change the <code class="docutils literal notranslate"><span class="pre">describe_animal</span></code> to
return a <code class="docutils literal notranslate"><span class="pre">f-string</span></code> instead - which will not throw any error at all, leading to
hidden bugs!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">describe_animal</span><span class="p">(</span><span class="n">animal</span><span class="p">:</span> <span class="n">Animal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">2</span>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">animal</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="si">}</span><span class="s2"> makes sound </span><span class="si">{</span><span class="n">animal</span><span class="o">.</span><span class="n">make_sound</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="n">robot</span> <span class="o">=</span> <span class="n">Robot</span><span class="p">()</span>
<span class="linenos">5</span><span class="n">robot_sound</span> <span class="o">=</span> <span class="n">describe_animal</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>
<span class="linenos">6</span><span class="nb">print</span><span class="p">(</span><span class="n">robot_sound</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Robot makes sound 1
</pre></div>
</div>
</div>
</div>
<p>and this can often happen in code, sometimes unknowingly.</p>
<p>In the for loop below, we iterate over entities that are presumed to be <code class="docutils literal notranslate"><span class="pre">Animal</span></code>
types. However, including a <code class="docutils literal notranslate"><span class="pre">Robot</span></code> in the list leads to a violation of type
safety that might only be caught at runtime, or worse, not caught at all,
potentially allowing a bug to go unnoticed until it causes a failure in a
production environment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">entities</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dog</span><span class="p">,</span> <span class="n">Cat</span><span class="p">,</span> <span class="n">Robot</span><span class="p">]</span>
<span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">entities</span><span class="p">:</span>
    <span class="n">describe_animal</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="further-violation-of-type-safety">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Further Violation of Type Safety</a><a class="headerlink" href="#further-violation-of-type-safety" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">old</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.01</span>
<span class="linenos">2</span><span class="n">new</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
<span class="linenos">3</span><span class="n">old</span> <span class="o">=</span> <span class="n">new</span>  <span class="c1"># Safe because int &lt;: float</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">old</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
<span class="linenos">2</span><span class="n">new</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.03</span>
<span class="linenos">3</span><span class="n">old</span> <span class="o">=</span> <span class="n">new</span>  <span class="c1"># Unsafe because int &lt;: float</span>
<span class="linenos">4</span><span class="c1"># assume the static language doesnt compile error then old will truncate to 3 silently because it is defined as an `int`!</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="references-and-further-readings">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">References and Further Readings</a><a class="headerlink" href="#references-and-further-readings" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://nus-cs2030s.github.io/2021-s2/02-type.html">Unit 2: Variable and Type - CS2030S</a></p></li>
<li><p><a class="reference external" href="https://peps.python.org/pep-0483/">PEP 483 – The Theory of Type Hints</a></p></li>
<li><p><a class="reference external" href="https://wiki.edunitas.com/IT/en/114-10/Subtyping_4238_eduNitas.html">Subtyping - eduNitas</a></p></li>
</ul>
<hr class="footnotes docutils" />
<aside class="footnote brackets" id="what-is-a-criterion" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>A criterion is a principle or standard by which something may be judged or
decided. In this context, the criterion for subtype is the principle or
standard by which we decide if one type is a subtype of another type.</p>
</aside>
<aside class="footnote brackets" id="cs2040s-variable-and-type" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://nus-cs2030s.github.io/2021-s2/02-type.html">Unit 2: Variable and Type - CS2030S</a></p>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./computer_science/type_theory"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01-subtypes.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Subtypes</p>
      </div>
    </a>
    <a class="right-next"
       href="03-subsumption.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Subsumption</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Type Safety</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-type-safe-example">A Type Safe Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#violating-type-safety">Violating Type Safety</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-violation-of-type-safety">Further Violation of Type Safety</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references-and-further-readings">References and Further Readings</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gao Hongnan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>