
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Generics and Type Variables &#8212; Omniverse</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=bb35926c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-MYW5YKC2WF"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MYW5YKC2WF');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MYW5YKC2WF');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'computer_science/type_theory/04-generics';</script>
    <link rel="canonical" href="https://www.gaohongnan.com/computer_science/type_theory/04-generics.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bound and Constraint in Generics and Type Variables" href="05-typevar-bound-constraints.html" />
    <link rel="prev" title="Subsumption" href="03-subsumption.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Omniverse - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Omniverse - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    🌌 Omniverse: A Journey Through Knowledge
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Notations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notations/machine_learning.html">Machine Learning Notations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Influential Ideas and Papers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../influential/generative_pretrained_transformer/01_intro.html">Generative Pre-trained Transformers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../influential/generative_pretrained_transformer/02_notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../influential/generative_pretrained_transformer/03_concept.html">The Concept of Generative Pre-trained Transformers (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../influential/generative_pretrained_transformer/04_implementation.html">The Implementation of Generative Pre-trained Transformers (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../influential/generative_pretrained_transformer/05_adder.html">Training a Mini-GPT to Learn Two-Digit Addition</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../influential/low_rank_adaptation/01_intro.html">Low-Rank Adaptation Of Large Language Models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../influential/low_rank_adaptation/02_concept.html">Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../influential/low_rank_adaptation/03_implementation.html">Implementation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../influential/kmeans_clustering/01_intro.html">K-Means</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../influential/kmeans_clustering/02_concept.html">Concept: K-Means Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../influential/kmeans_clustering/03_implementation.html">Implementation: K-Means (Lloyd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../influential/kmeans_clustering/04_image_segmentation.html">Application: Image Compression and Segmentation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Playbook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../playbook/how_to_calculate_flops_in_transformer_based_models.html">How to Calculate the Number of FLOPs in Transformer Based Models?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playbook/how_to_inspect_function_and_class_signatures.html">How to Inspect Function and Class Signatures in Python?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playbook/why_cosine_annealing_warmup_stabilize_training.html">Why Does Cosine Annealing With Warmup Stabilize Training?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playbook/why_softmax_preserves_order_translation_invariant_not_invariant_scaling.html">Softmax Preserves Order, Is Translation Invariant But Not Invariant Under Scaling.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playbook/how_to_finetune_decoder_with_last_token_pooling.html">How To Fine-Tune Decoder-Only Models For Sequence Classification Using Last Token Pooling?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playbook/how_to_finetune_decoder_with_cross_attention.html">How To Fine-Tune Decoder-Only Models For Sequence Classification With Cross-Attention?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Operations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../operations/machine_learning_lifecycle/00_intro.html">The Lifecycle of an AIOps System</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../operations/machine_learning_lifecycle/01_problem_formulation.html">Stage 1. Problem Formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/machine_learning_lifecycle/02_project_scoping.html">Stage 2. Project Scoping And Framing The Problem</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../operations/machine_learning_lifecycle/03_dataops_pipeline/03_dataops_pipeline.html">Stage 3. Data Pipeline (Data Engineering and DataOps)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/03_dataops_pipeline/031_data_source_and_format.html">Stage 3.1. Data Source and Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/03_dataops_pipeline/032_data_model_and_storage.html">Stage 3.2. Data Model and Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/03_dataops_pipeline/033_etl.html">Stage 3.3. Extract, Transform, Load (ETL)</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/machine_learning_lifecycle/04_mlops_data_pipeline.html">Stage 4. Data Extraction (MLOps), Data Analysis (Data Science), Data Preparation (Data Science)</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../operations/machine_learning_lifecycle/05_model_development_selection_and_training/05_ml_training_pipeline.html">Stage 5. Model Development and Training (MLOps)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/05_model_development_selection_and_training/051_model_selection.html">Stage 5.1. Model Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/05_model_development_selection_and_training/052_metric_selection.html">Stage 5.2. Metric Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/05_model_development_selection_and_training/053_experiment_tracking.html">Stage 5.3. Experiment Tracking And Versioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/05_model_development_selection_and_training/054_model_testing.html">Stage 5.4. Model Testing</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../operations/distributed/intro.html">Distributed Systems</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../operations/distributed/01_notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/distributed/02_basics.html">Basics Of Distributed Data Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/distributed/03_how_to_setup_slurm_in_aws.html">How to Setup SLURM and ParallelCluster in AWS</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Software Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../software_engineering/config_management/concept.html">Configuration Management</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/config_management/01-pydra.html">Pydantic And Hydra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/config_management/02-state.html">State And Metadata Management</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../software_engineering/devops/continuous-integration/concept.html">Continuous Integration (CI) Workflow</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/devops/continuous-integration/styling.html">Styling, Formatting, and Linting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/devops/continuous-integration/testing.html">Testing</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../software_engineering/design_patterns/dependency-inversion-principle.html">Dependency Inversion Principle</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../software_engineering/concurrency_parallelism_asynchronous/intro.html">Concurrency, Parallelism and Asynchronous Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/concurrency_parallelism_asynchronous/generator_yield.html">A Rudimentary Introduction to Generator and Yield in Python</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../software_engineering/serving/restful_api/intro.html">RESTful API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/serving/restful_api/application_banking.html">Application: Designing a RESTful Banking API with FastAPI and SQLAlchemy</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Science</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Type Theory, A Very Rudimentary Introduction</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01-subtypes.html">Subtypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-type-safety.html">Type Safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-subsumption.html">Subsumption</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Generics and Type Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-typevar-bound-constraints.html">Bound and Constraint in Generics and Type Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-invariance-covariance-contravariance.html">Invariance, Covariance and Contravariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-pep-3124-overloading.html">Function Overloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="08-pep-661-sentinel-values.html">Sentinel Types</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Structures and Algorithms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/complexity_analysis/intro.html">Complexity Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/complexity_analysis/master_theorem.html">Master Theorem </a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/stack/intro.html">Stack</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/stack/concept.html">Concept</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/searching_algorithms/linear_search/intro.html">Linear Search</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/searching_algorithms/linear_search/concept.html">Concept</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/searching_algorithms/binary_search/intro.html">Binary Search</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/searching_algorithms/binary_search/concept.html">Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/searching_algorithms/binary_search/problems/875-koko-eating-bananas.html">Koko Eating Bananas</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Algebra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../linear_algebra/01_preliminaries/intro.html">Preliminaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/01_preliminaries/01-fields.html">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/01_preliminaries/02-systems-of-linear-equations.html">Systems of Linear Equations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../linear_algebra/02_vectors/intro.html">Vectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/01-vector-definition.html">Vector and Its Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/02-vector-operation.html">Vector and Its Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/03-vector-norm.html">Vector Norm and Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/04-vector-products.html">A First Look at Vector Products</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References, Resources and Roadmap</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citations.html">IEEE (Style) Citations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../api/reproducibility.html">API Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/gao-hongnan/omniverse/blob/main/omniverse/computer_science/type_theory/04-generics.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/gao-hongnan/omniverse" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gao-hongnan/omniverse/issues/new?title=Issue%20on%20page%20%2Fcomputer_science/type_theory/04-generics.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/computer_science/type_theory/04-generics.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../_sources/computer_science/type_theory/04-generics.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Generics and Type Variables</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-motivation">The Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#containers-are-generics">Containers are Generics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Generics and Type Variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generics">Generics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-variable-and-type-parameter">Type Variable and Type Parameter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-argument">Type Argument</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pair-problem-revisited">Pair Problem Revisited</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scope-of-generic-methods-and-functions">Scope of Generic Methods and Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-functions">Generic Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-methods">Generic Methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references-and-further-readings">References and Further Readings</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="generics-and-type-variables">
<h1>Generics and Type Variables<a class="headerlink" href="#generics-and-type-variables" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://twitter.com/gaohongnan"><img alt="Twitter Handle" src="https://img.shields.io/badge/Twitter-&#64;gaohongnan-blue?style=social&amp;logo=twitter" /></a>
<a class="reference external" href="https://linkedin.com/in/gao-hongnan"><img alt="LinkedIn Profile" src="https://img.shields.io/badge/&#64;gaohongnan-blue?style=social&amp;logo=linkedin" /></a>
<a class="reference external" href="https://github.com/gao-hongnan"><img alt="GitHub Profile" src="https://img.shields.io/badge/GitHub-gao--hongnan-lightgrey?style=social&amp;logo=github" /></a>
<img alt="Tag" src="https://img.shields.io/badge/Tag-Brain_Dump-red" />
<img alt="Tag" src="https://img.shields.io/badge/Level-Beginner-green" /></p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#the-motivation" id="id10">The Motivation</a></p></li>
<li><p><a class="reference internal" href="#containers-are-generics" id="id11">Containers are Generics</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id12">Generics and Type Variables</a></p>
<ul>
<li><p><a class="reference internal" href="#generics" id="id13">Generics</a></p></li>
<li><p><a class="reference internal" href="#type-variable-and-type-parameter" id="id14">Type Variable and Type Parameter</a></p></li>
<li><p><a class="reference internal" href="#type-argument" id="id15">Type Argument</a></p></li>
<li><p><a class="reference internal" href="#pair-problem-revisited" id="id16">Pair Problem Revisited</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#scope-of-generic-methods-and-functions" id="id17">Scope of Generic Methods and Functions</a></p>
<ul>
<li><p><a class="reference internal" href="#generic-functions" id="id18">Generic Functions</a></p></li>
<li><p><a class="reference internal" href="#generic-methods" id="id19">Generic Methods</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#references-and-further-readings" id="id20">References and Further Readings</a></p></li>
</ul>
</nav>
<p>This article is closely aligned with and draws inspiration from the materials
provided in
<a class="reference external" href="https://nus-cs2030s.github.io/2021-s2/20-generics.html">Unit 20: Generics</a> of
the CS2030S course at the National University of Singapore. Some sections have
been adapted and rephrased for clarity and context, in particular translating
the Java code to Python.</p>
<section id="the-motivation">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">The Motivation</a><a class="headerlink" href="#the-motivation" title="Link to this heading">#</a></h2>
<p>In some scenarios, crafting a simple class to aggregate a duo of variables
proves beneficial, especially when a method needs to output two distinct values.
Consider, for instance, the <code class="docutils literal notranslate"><span class="pre">IntPair</span></code> class, which groups two integer variables.
This class serves merely as a utility, lacking any complex semantics or methods,
and thus, its internal workings are left exposed for simplicity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="nd">@dataclass</span>
<span class="linenos"> 4</span><span class="k">class</span> <span class="nc">IntPair</span><span class="p">:</span>
<span class="linenos"> 5</span>    <span class="n">first</span><span class="p">:</span> <span class="nb">int</span>
<span class="linenos"> 6</span>    <span class="n">second</span><span class="p">:</span> <span class="nb">int</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>    <span class="k">def</span> <span class="nf">get_first</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="linenos"> 9</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span>
<span class="linenos">10</span>
<span class="linenos">11</span>    <span class="k">def</span> <span class="nf">get_second</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="linenos">12</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span>
</pre></div>
</div>
</div>
</div>
<p>Such a class is ideal for use cases like a function that needs to return a pair
of integers, exemplified by a hypothetical <code class="docutils literal notranslate"><span class="pre">find_min_max</span></code> function that
determines the minimum and maximum values in an array of integers. However, this
raises a question: what if the need arises to identify the minimum and maximum
in an array of floats?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">def</span> <span class="nf">find_min_max</span><span class="p">(</span><span class="n">array</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">IntPair</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="n">min_val</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>  <span class="c1"># Largest possible int</span>
<span class="linenos"> 3</span>    <span class="n">max_val</span> <span class="o">=</span> <span class="o">-</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Smallest possible int</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">array</span><span class="p">:</span>
<span class="linenos"> 6</span>        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="n">min_val</span><span class="p">:</span>
<span class="linenos"> 7</span>            <span class="n">min_val</span> <span class="o">=</span> <span class="n">num</span>
<span class="linenos"> 8</span>        <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="n">max_val</span><span class="p">:</span>
<span class="linenos"> 9</span>            <span class="n">max_val</span> <span class="o">=</span> <span class="n">num</span>
<span class="linenos">10</span>
<span class="linenos">11</span>    <span class="k">return</span> <span class="n">IntPair</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To address a broader range of types, one could theorize the creation of
additional pair classes, such as <code class="docutils literal notranslate"><span class="pre">DoublePair</span></code> for floats or <code class="docutils literal notranslate"><span class="pre">BooleanPair</span></code> for
booleans. Alternatively, designing a pair class that accommodates a combination
of different types, like pairing a <code class="docutils literal notranslate"><span class="pre">Customer</span></code> object with a <code class="docutils literal notranslate"><span class="pre">ServiceCounter</span></code>, or
a string with an integer, could offer more versatility.</p>
<p>However, it’s impractical and inefficient to design a separate class for each
potential type pairing. A more elegant solution is to design a generic pair
class capable of encapsulating any two types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nd">@dataclass</span>
<span class="linenos"> 2</span><span class="k">class</span> <span class="nc">Pair</span><span class="p">:</span>
<span class="linenos"> 3</span>    <span class="n">first</span><span class="p">:</span> <span class="n">Any</span>
<span class="linenos"> 4</span>    <span class="n">second</span><span class="p">:</span> <span class="n">Any</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>    <span class="k">def</span> <span class="nf">get_first</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="linenos"> 7</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>    <span class="k">def</span> <span class="nf">get_second</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="linenos">10</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span>
</pre></div>
</div>
</div>
</div>
<p>This generic <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class can encompass any two types designated upon its
instantiation, providing a versatile structure that can hold any value types,
mirroring the flexibility previously applied in methods to accommodate various
object types.</p>
<p>Nevertheless, this approach is not without its drawbacks, notably the issue of
type conversion narrowing and the potential for runtime errors. For example, if
a function mistakenly returns a <code class="docutils literal notranslate"><span class="pre">Pair</span></code> with a string and an integer but treats
it inversely, static type checking at compile-time won’t catch this discrepancy,
possibly leading to errors or crashes during execution. This highlights the
importance of careful type management and the limitations of relying solely on
runtime type identification.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">def</span> <span class="nf">create_misleading_pair</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Pair</span><span class="p">:</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;This function creates a Pair with a string and an integer.&quot;&quot;&quot;</span>
<span class="linenos"> 3</span>    <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="k">def</span> <span class="nf">process_misleading_pair</span><span class="p">(</span><span class="n">pair</span><span class="p">:</span> <span class="n">Pair</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 7</span><span class="sd">    Process elements of the pair, with incorrect assumptions about their types.</span>
<span class="linenos"> 8</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>    <span class="c1"># The programmer incorrectly assumes the first element is an integer</span>
<span class="linenos">11</span>    <span class="c1"># and the second element is a string.</span>
<span class="linenos">12</span>    <span class="k">try</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="n">first_element</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_first</span><span class="p">())</span>  <span class="c1"># Mistakenly assuming it&#39;s an int</span>
<span class="linenos">14</span>        <span class="n">second_element</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_second</span><span class="p">())</span>  <span class="c1"># Mistakenly assuming it&#39;s a str</span>
<span class="linenos">15</span>        <span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos">16</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_first</span><span class="p">())</span>
<span class="linenos">17</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_second</span><span class="p">())</span>
<span class="linenos">18</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">first_element</span><span class="p">)</span>
<span class="linenos">19</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">second_element</span><span class="p">)</span>
<span class="linenos">20</span>            <span class="n">reveal_locals</span><span class="p">()</span>
<span class="linenos">21</span>
<span class="linenos">22</span>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="linenos">23</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="c1"># Example Usage</span>
<span class="linenos">26</span><span class="n">pair</span> <span class="o">=</span> <span class="n">create_misleading_pair</span><span class="p">()</span>
<span class="linenos">27</span><span class="n">process_misleading_pair</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: invalid literal for int() with base 10: &#39;hello&#39;
</pre></div>
</div>
</div>
</div>
<p>Why does the compiler not be able to detect the type mismatch and stop the
program from crashing during run-time? In fact, if you run the type checker
<code class="docutils literal notranslate"><span class="pre">mypy</span></code> on the above code, it will not raise any error. You can also add
<code class="docutils literal notranslate"><span class="pre">reveal_type</span></code> and <code class="docutils literal notranslate"><span class="pre">reveal_locals</span></code> to the code to see the type of <code class="docutils literal notranslate"><span class="pre">first_element</span></code>
and <code class="docutils literal notranslate"><span class="pre">second_element</span></code> and the local variables.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">16</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span> <span class="n">Revealed</span> <span class="nb">type</span> <span class="ow">is</span> <span class="s2">&quot;builtins.int&quot;</span>
<span class="mi">17</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span> <span class="n">Revealed</span> <span class="nb">type</span> <span class="ow">is</span> <span class="s2">&quot;builtins.str&quot;</span>
<span class="mi">18</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span> <span class="n">Revealed</span> <span class="n">local</span> <span class="n">types</span> <span class="n">are</span><span class="p">:</span>
<span class="mi">18</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span>     <span class="n">first_element</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">int</span>
<span class="mi">18</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span>     <span class="n">pair</span><span class="p">:</span> <span class="n">Pair</span>
<span class="mi">18</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span>     <span class="n">second_element</span><span class="p">:</span> <span class="n">builtins</span><span class="o">.</span><span class="n">str</span>
</pre></div>
</div>
<p>Only when you run the code, then the error occur. What’s worse, is that the
error is silent in both compile and run time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">def</span> <span class="nf">create_silent_error_pair</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Pair</span><span class="p">:</span>
<span class="linenos"> 2</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;This function creates a Pair with a string and an integer.&quot;&quot;&quot;</span>
<span class="linenos"> 3</span>    <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="s1">&#39;16&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">)</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="k">def</span> <span class="nf">process_silent_error_pair</span><span class="p">(</span><span class="n">pair</span><span class="p">:</span> <span class="n">Pair</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 7</span><span class="sd">    Process elements of the pair, with incorrect assumptions about their types.</span>
<span class="linenos"> 8</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>    <span class="k">try</span><span class="p">:</span>
<span class="linenos">11</span>        <span class="n">first_element</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_first</span><span class="p">())</span>
<span class="linenos">12</span>        <span class="n">second_element</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_second</span><span class="p">())</span>
<span class="linenos">13</span>        <span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos">14</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">first_element</span><span class="p">)</span>
<span class="linenos">15</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">second_element</span><span class="p">)</span>
<span class="linenos">16</span>            <span class="n">reveal_locals</span><span class="p">()</span>
<span class="linenos">17</span>
<span class="linenos">18</span>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="linenos">19</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">20</span>
<span class="linenos">21</span>    <span class="k">return</span> <span class="n">first_element</span> <span class="o">+</span> <span class="n">second_element</span>
</pre></div>
</div>
</div>
</div>
<p>And what is wrong in this code? The programmer actually wanted to create a pair
of <code class="docutils literal notranslate"><span class="pre">int</span></code> but mistakenly created a pair of <code class="docutils literal notranslate"><span class="pre">str</span></code> and want to add them together.
Instead of getting <code class="docutils literal notranslate"><span class="pre">20</span></code>, the result is <code class="docutils literal notranslate"><span class="pre">164</span></code>.</p>
<p>Running <code class="docutils literal notranslate"><span class="pre">mypy</span></code> on the above code will not raise any error as well, as they
inferred “correctly” here.</p>
<p>The problem here is that <code class="docutils literal notranslate"><span class="pre">Any</span></code> is too “generic” literally. When the programmer
write the return type of <code class="docutils literal notranslate"><span class="pre">create_misleading_pair</span></code> and <code class="docutils literal notranslate"><span class="pre">create_silent_error_pair</span></code>
as <code class="docutils literal notranslate"><span class="pre">Pair</span></code>, the there is no type binding to the <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class for the type of
<code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">second</span></code> attribute.</p>
<p>If there is a way to parameterize the <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class, then the type checker can
detect the type mismatch and stop the program from crashing during run-time. If
we can create two <em>generic</em> type variables, <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code>, both not necessarily
the same, then we can have a contract that the <code class="docutils literal notranslate"><span class="pre">first</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">Pair</span></code> is of
type <code class="docutils literal notranslate"><span class="pre">S</span></code> and the <code class="docutils literal notranslate"><span class="pre">second</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">Pair</span></code> is of type <code class="docutils literal notranslate"><span class="pre">T</span></code>, then necessarily,
the return type of <code class="docutils literal notranslate"><span class="pre">get_first</span></code> and <code class="docutils literal notranslate"><span class="pre">get_second</span></code> will be <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code>. If we can
do that, our problems may be solved.</p>
</section>
<section id="containers-are-generics">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Containers are Generics</a><a class="headerlink" href="#containers-are-generics" title="Link to this heading">#</a></h2>
<p>Let’s defer the solution to the motivation above and first understand some
practical examples of generics in Python. This is adapted from
<a class="reference external" href="https://www.playfulpython.com/python-type-hinting-generics-inheritance/">Type Hinting: Generics &amp; Inheritance</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nd">@dataclass</span>
<span class="linenos"> 2</span><span class="k">class</span> <span class="nc">Employee</span><span class="p">:</span>
<span class="linenos"> 3</span>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="linenos"> 4</span>    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 7</span>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>    <span class="k">def</span> <span class="nf">unique_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">10</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Python’s list is a dynamic array that can hold any type of object. This has its
advantages, but it also means that the type of the elements in the list is not
enforced. This can lead to bugs and errors that are difficult to track down.</p>
<p>For example, consider the following list of dynamic types:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">list_of_dynamic_types</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[</span><span class="n">Employee</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">]</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="k">try</span><span class="p">:</span>
<span class="linenos">4</span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_of_dynamic_types</span><span class="p">:</span>
<span class="linenos">5</span>        <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="fm">__str__</span><span class="p">())</span>
<span class="linenos">6</span>        <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">unique_id</span><span class="p">())</span>
<span class="linenos">7</span><span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="linenos">8</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Alice (1)
Alice (1)
1
Error: &#39;int&#39; object has no attribute &#39;unique_id&#39;
</pre></div>
</div>
</div>
</div>
<p>In the above code, the <code class="docutils literal notranslate"><span class="pre">list_of_dynamic_types</span></code> contains a mix of <code class="docutils literal notranslate"><span class="pre">Employee</span></code>,
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, and <code class="docutils literal notranslate"><span class="pre">float</span></code> objects. When we try to call the <code class="docutils literal notranslate"><span class="pre">__str__</span></code> and
<code class="docutils literal notranslate"><span class="pre">unique_id</span></code> methods on each item in the list, we get an <code class="docutils literal notranslate"><span class="pre">AttributeError</span></code> because
not all the items in the list have these methods.</p>
<p>To address this issue, we can use Python’s type hinting system to specify the
type of the elements in the list. This will allow the type checker to catch
errors at compile time, rather than at run time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">list_of_employees</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Employee</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Employee</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Employee</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="linenos"> 2</span><span class="n">list_of_ints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="linenos"> 3</span><span class="n">list_of_strings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">]</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos"> 6</span>    <span class="n">reveal_type</span><span class="p">(</span><span class="n">list_of_employees</span><span class="p">)</span>  <span class="c1"># Revealed type is &#39;List[Employee]&#39;</span>
<span class="linenos"> 7</span>    <span class="n">reveal_type</span><span class="p">(</span><span class="n">list_of_ints</span><span class="p">)</span>  <span class="c1"># Revealed type is &#39;List[int]&#39;</span>
<span class="linenos"> 8</span>    <span class="n">reveal_type</span><span class="p">(</span><span class="n">list_of_strings</span><span class="p">)</span>  <span class="c1"># Revealed type is &#39;List[str]&#39;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="k">for</span> <span class="n">employee</span> <span class="ow">in</span> <span class="n">list_of_employees</span><span class="p">:</span>
<span class="linenos">11</span>    <span class="nb">print</span><span class="p">(</span><span class="n">employee</span><span class="o">.</span><span class="n">unique_id</span><span class="p">())</span> <span class="c1"># this will not raise any error because mypy knows each employee is of type Employee and has unique_id method</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Alice (1)
Bob (2)
</pre></div>
</div>
</div>
</div>
<p>And if you append <code class="docutils literal notranslate"><span class="pre">Employee</span></code> to <code class="docutils literal notranslate"><span class="pre">list_of_ints</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">list_of_ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Employee</span><span class="p">(</span><span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># Error: Argument 1 to &quot;append&quot; of &quot;list&quot; has incompatible type &quot;Employee&quot;; expected &quot;int&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Running <code class="docutils literal notranslate"><span class="pre">mypy</span></code> will yield:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">150</span>:<span class="w"> </span>error:<span class="w"> </span>Argument<span class="w"> </span><span class="m">1</span><span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;append&quot;</span><span class="w"> </span>of<span class="w"> </span><span class="s2">&quot;list&quot;</span><span class="w"> </span>has<span class="w"> </span>incompatible<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s2">&quot;Employee&quot;</span><span class="p">;</span><span class="w"> </span>expected<span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="w">  </span><span class="o">[</span>arg-type<span class="o">]</span>
<span class="w">    </span>list_of_ints.append<span class="o">(</span>Employee<span class="o">(</span><span class="s2">&quot;Charlie&quot;</span>,<span class="w"> </span><span class="m">3</span><span class="o">))</span><span class="w">  </span><span class="c1"># Error: Argument 1 to &quot;append&quot; of &quot;list&quot; has incompatible type &quot;Employee&quot;; expected &quot;int&quot;</span>
</pre></div>
</div>
<p>So why do we say containers are generics? If you notice, when we type hint
<code class="docutils literal notranslate"><span class="pre">list_of_employees</span></code>, <code class="docutils literal notranslate"><span class="pre">list_of_ints</span></code>, and <code class="docutils literal notranslate"><span class="pre">list_of_strings</span></code>, we are actually
using a generic type <code class="docutils literal notranslate"><span class="pre">List</span></code> with a type parameter <code class="docutils literal notranslate"><span class="pre">Employee</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, and <code class="docutils literal notranslate"><span class="pre">str</span></code>
respectively via <code class="docutils literal notranslate"><span class="pre">List[Employee]</span></code>, <code class="docutils literal notranslate"><span class="pre">List[int]</span></code>, and <code class="docutils literal notranslate"><span class="pre">List[str]</span></code>. This is the
same as the <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class we defined in the motivation above. The <code class="docutils literal notranslate"><span class="pre">List</span></code> class is
a generic class that can hold any type of object, and the type parameter
specifies the type of the elements in the list.</p>
<p>How do we use generics and typevar in this context?</p>
<p>Consider a very simple function that just want to append an <code class="docutils literal notranslate"><span class="pre">int</span></code> element to a
list and return the list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">append_int_and_return_list</span><span class="p">(</span><span class="n">list_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">element</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="linenos">2</span>    <span class="n">list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
<span class="linenos">3</span>    <span class="k">return</span> <span class="n">list_</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="n">list_of_ints</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="linenos">6</span><span class="n">new_list_of_ints</span> <span class="o">=</span> <span class="n">append_int_and_return_list</span><span class="p">(</span><span class="n">list_of_ints</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="linenos">7</span><span class="nb">print</span><span class="p">(</span><span class="n">new_list_of_ints</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4]
</pre></div>
</div>
</div>
</div>
<p>and another function that just want to append a <code class="docutils literal notranslate"><span class="pre">str</span></code> element to a list and
return the list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">append_str_and_return_list</span><span class="p">(</span><span class="n">list_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">element</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="linenos">2</span>    <span class="n">list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
<span class="linenos">3</span>    <span class="k">return</span> <span class="n">list_</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="n">list_of_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">]</span>
<span class="linenos">6</span><span class="n">new_list_of_strings</span> <span class="o">=</span> <span class="n">append_str_and_return_list</span><span class="p">(</span><span class="n">list_of_strings</span><span class="p">,</span> <span class="s2">&quot;!&quot;</span><span class="p">)</span>
<span class="linenos">7</span><span class="nb">print</span><span class="p">(</span><span class="n">new_list_of_strings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;hello&#39;, &#39;world&#39;, &#39;!&#39;]
</pre></div>
</div>
</div>
</div>
<p>The above two functions are very similar, and the only difference is the type of
the list and the type of the element. We really do not want two functions doing
the same thing as the <code class="docutils literal notranslate"><span class="pre">append</span></code> method is well defined for the <code class="docutils literal notranslate"><span class="pre">List</span></code> class. We
can use <code class="docutils literal notranslate"><span class="pre">Any</span></code> as the type of the list and the element, but this will not catch
type errors at compile time if we silently slip in a <code class="docutils literal notranslate"><span class="pre">str</span></code> to a list of <code class="docutils literal notranslate"><span class="pre">int</span></code> or
vice versa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">append_and_return_list</span><span class="p">(</span><span class="n">list_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">element</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="linenos">2</span>    <span class="n">list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
<span class="linenos">3</span>    <span class="k">return</span> <span class="n">list_</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="n">list_of_ints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="linenos">6</span><span class="n">new_list_of_ints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">append_and_return_list</span><span class="p">(</span><span class="n">list_of_ints</span><span class="p">,</span> <span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="linenos">7</span><span class="nb">print</span><span class="p">(</span><span class="n">new_list_of_ints</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, &#39;hello&#39;]
</pre></div>
</div>
</div>
</div>
<p>In comes the type variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">def</span> <span class="nf">append_and_return_list</span><span class="p">(</span><span class="n">list_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">element</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<span class="linenos"> 4</span>    <span class="n">list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
<span class="linenos"> 5</span>    <span class="k">return</span> <span class="n">list_</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">list_of_ints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1"># This will cause a mypy error</span>
<span class="linenos">10</span><span class="n">new_list_of_ints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">append_and_return_list</span><span class="p">(</span><span class="n">list_</span><span class="o">=</span><span class="n">list_of_ints</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s2">&quot;abcedf&quot;</span><span class="p">)</span>
<span class="linenos">11</span><span class="nb">print</span><span class="p">(</span><span class="n">new_list_of_ints</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5, &#39;abcedf&#39;]
</pre></div>
</div>
</div>
</div>
<p>Running <code class="docutils literal notranslate"><span class="pre">mypy</span></code> on the above code will yield:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">10</span>:<span class="w"> </span>error:<span class="w"> </span>Argument<span class="w"> </span><span class="s2">&quot;element&quot;</span><span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;append_and_return_list&quot;</span><span class="w"> </span>has<span class="w"> </span>incompatible<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s2">&quot;str&quot;</span><span class="p">;</span><span class="w"> </span>expected<span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="w">  </span><span class="o">[</span>arg-type<span class="o">]</span>
<span class="w">    </span>new_list_of_ints:<span class="w"> </span>List<span class="o">[</span>int<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>append_and_return_list<span class="o">(</span><span class="nv">list_</span><span class="o">=</span>list_of_ints,<span class="w"> </span><span class="nv">element</span><span class="o">=</span><span class="s2">&quot;abcedf&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>By now, we can spot the pattern from the examples above. Our list is a
container, it is called a generic container because it can hold any type of
object parameterized by the type parameter/variable <code class="docutils literal notranslate"><span class="pre">T</span></code>. The <code class="docutils literal notranslate"><span class="pre">T</span></code> is a type
variable, and it is a placeholder for the actual type that will be used when the
function is called.</p>
<p><code class="docutils literal notranslate"><span class="pre">T</span></code> <em>generalizes</em> the type in the list: <code class="docutils literal notranslate"><span class="pre">List[int]</span></code>, <code class="docutils literal notranslate"><span class="pre">List[str]</span></code>,
<code class="docutils literal notranslate"><span class="pre">List[Employee]</span></code>, etc and <code class="docutils literal notranslate"><span class="pre">T</span></code> is called a variable because it is literally a
<em>variable of types</em>. <code class="docutils literal notranslate"><span class="pre">List[str]</span></code> is a <em>specific</em> type, and <code class="docutils literal notranslate"><span class="pre">List[T]</span></code> is a
<em>generic</em> type that can represent any specific type. Consequently, <code class="docutils literal notranslate"><span class="pre">List[T]</span></code> is
a <em>generic type</em> and <code class="docutils literal notranslate"><span class="pre">T</span></code> is a <em>type variable</em><a class="footnote-reference brackets" href="#id6" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<div class="proof remark admonition" id="computer-science-type-theory-generics-why-use-t">
<p class="admonition-title"><span class="caption-number">Remark 14 </span> (Why not just use Any?)</p>
<section class="remark-content" id="proof-content">
<p>You might wonder why we use a type variable <code class="docutils literal notranslate"><span class="pre">T</span></code> to denote generality in types,
rather than simply using <code class="docutils literal notranslate"><span class="pre">Any</span></code>, given that both seem to imply a kind of
universality. However, there’s a crucial distinction between them in terms of
type safety.</p>
<p>The type variable <code class="docutils literal notranslate"><span class="pre">T</span></code> is generic, meaning it represents a specific but
unspecified type across the context in which it’s used. This specificity allows
for type consistency within a given scope. For example, if a function is defined
to accept a list of type <code class="docutils literal notranslate"><span class="pre">List[T]</span></code> and an element of type <code class="docutils literal notranslate"><span class="pre">T</span></code>, <code class="docutils literal notranslate"><span class="pre">T</span></code> will be the
same type for both the list and the element. This generic but consistent typing
ensures that the function can operate on a list and an element of the same,
though unspecified, type, thereby maintaining type safety by preventing type
mismatches.</p>
<p>On the other hand, <code class="docutils literal notranslate"><span class="pre">Any</span></code> is indeed “more generic” but in a way that bypasses
type safety checks. Declaring a list as <code class="docutils literal notranslate"><span class="pre">List[Any]</span></code> tells the type checker that
the list can contain elements of any type, effectively disabling type safety for
elements of that list. This means that both integers and strings (and any other
type) can coexist in such a list without raising type errors at compile-time or
during static analysis. While this provides flexibility, it sacrifices the
guarantees that come with stricter type checking.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">Any</span></code> indiscriminately can lead to silent type errors where, for instance,
a string is accidentally added to a list of integers. The type system won’t
catch this mix-up at compile-time or during static analysis with <code class="docutils literal notranslate"><span class="pre">mypy</span></code>, leading
to potential runtime errors or bugs that are harder to trace and fix.</p>
</section>
</div><p>You can find another custom example on implementing a stack using generics in
the
<a class="reference external" href="https://www.gaohongnan.com/dsa/stack/concept.html#the-importance-of-generic-types">Stack - Omniverse</a>
page.</p>
</section>
<section id="id2">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Generics and Type Variables</a><a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<section id="generics">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Generics</a><a class="headerlink" href="#generics" title="Link to this heading">#</a></h3>
<p>Generics enable the construction of new, more specific types from abstract type
definitions by using what are known as <strong>generic type constructors</strong>. These
constructors operate at the type level, similar to how functions operate at the
value level.</p>
<ul class="simple">
<li><p><strong>Generic Type</strong>: A generic type is a type definition that includes one or
more type variables. It’s a template from which concrete types can be
constructed. For example, <code class="docutils literal notranslate"><span class="pre">Tuple[T]</span></code> or more broadly <code class="docutils literal notranslate"><span class="pre">Tuple[T,</span> <span class="pre">...]</span></code> (using
Python’s typing syntax) is the generic type. It’s not <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> itself that’s
the generic type, but rather <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> parameterized with type variables like
<code class="docutils literal notranslate"><span class="pre">T</span></code> or with specific types (we usually call the realization of the generic
type as a <em>parameterized type</em><a class="footnote-reference brackets" href="#id7" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> (concrete type)).</p></li>
<li><p><strong>Generic Type Constructor</strong>: This term refers to the mechanism by which
generic types like <code class="docutils literal notranslate"><span class="pre">Tuple[T,</span> <span class="pre">...]</span></code> are used to create new, parameterized
types. The constructor takes a type (or types) as an argument and “returns”
a new parameterized type based on the generic definition. For instance, when
you use <code class="docutils literal notranslate"><span class="pre">Tuple[float,</span> <span class="pre">...]</span></code>, you’re invoking the generic type constructor of
<code class="docutils literal notranslate"><span class="pre">Tuple</span></code> with <code class="docutils literal notranslate"><span class="pre">float</span></code> as the argument, resulting in a new parameterized type
that can be thought of as a vector of floats.</p></li>
</ul>
<p>Here are two examples illustrating this concept:</p>
<ol class="arabic simple">
<li><p><strong>Vector Example</strong>: When <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> is parameterized with <code class="docutils literal notranslate"><span class="pre">float</span></code> and an
ellipsis (<code class="docutils literal notranslate"><span class="pre">...</span></code>) indicating a variable length, <code class="docutils literal notranslate"><span class="pre">Tuple[float,</span> <span class="pre">...]</span></code> acts as a
parameterized type that could represent a mathematical vector of floats. In
this scenario, <code class="docutils literal notranslate"><span class="pre">Tuple[float,</span> <span class="pre">...]</span></code> is a parameterized type derived from the
generic type <code class="docutils literal notranslate"><span class="pre">Tuple[T,</span> <span class="pre">...]</span></code> by specifying <code class="docutils literal notranslate"><span class="pre">float</span></code> as the type argument.</p></li>
<li><p><strong>Registry Example</strong>: Similarly, by parameterizing <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> with another type,
such as <code class="docutils literal notranslate"><span class="pre">UserID</span></code> (assuming <code class="docutils literal notranslate"><span class="pre">UserID</span></code> is a type you’ve defined elsewhere),
<code class="docutils literal notranslate"><span class="pre">Tuple[UserID,</span> <span class="pre">...]</span></code> becomes a parameterized type that could represent a
registry of user IDs. Again, <code class="docutils literal notranslate"><span class="pre">Tuple[UserID,</span> <span class="pre">...]</span></code> is a parameterized type
constructed from the generic type <code class="docutils literal notranslate"><span class="pre">Tuple[T,</span> <span class="pre">...]</span></code> using <code class="docutils literal notranslate"><span class="pre">UserID</span></code> as the type
argument.</p></li>
</ol>
<p>Such semantics is known as <em>generic type constructor</em>, which is similar to the
semantics of functions, where a function takes a value and returns a value. In
this case, a generic type constructor takes a type and returns a type<a class="footnote-reference brackets" href="#id8" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
</section>
<section id="type-variable-and-type-parameter">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Type Variable and Type Parameter</a><a class="headerlink" href="#type-variable-and-type-parameter" title="Link to this heading">#</a></h3>
<p>A <strong>type variable</strong> is a placeholder used in generic programming to denote a
type that is not specified at the point of declaration but will be determined
later, at the time of use. Type variables allow the definition of generic types
or functions that can operate on any data type. They are essentially the
variables of type expressions.</p>
<p>A <strong>type parameter</strong> is similar to a type variable, but the term is often used
in the context of defining generic classes, interfaces, or methods. The type
parameter is declared as a part of a generic type or method definition and
specifies a placeholder that will be replaced with an actual type when the
generic type is instantiated or the generic method is invoked. It allows for the
creation of parameterized types or methods where the specific type(s) to be used
are specified when a class is instantiated or a method is called.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">T</span></code> defined via <code class="docutils literal notranslate"><span class="pre">TypeVar</span></code> is a type variable, and it is a placeholder for
the actual type that will be used when the function is called. For instance,
looking at the function below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">append_and_return_list</span><span class="p">(</span><span class="n">list_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">element</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="n">list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">list_</span>
</pre></div>
</div>
<p>We do not know what <code class="docutils literal notranslate"><span class="pre">T</span></code> is at the time of defining the function, but we know
that <code class="docutils literal notranslate"><span class="pre">T</span></code> will be a type of the list and the element when the function is called.</p>
</section>
<section id="type-argument">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Type Argument</a><a class="headerlink" href="#type-argument" title="Link to this heading">#</a></h3>
<p>A <strong>type argument</strong> refers to the concrete type that is supplied in place of a
type variable or parameter when a generic class, interface, or method is
actually used. It effectively “fills in” the generic placeholder with a specific
type, thereby instantiating or invoking the generic entity with that specific
type. The type argument provides the actual type information that allows the
generic mechanism to operate on specific data types, ensuring type safety and
consistency.</p>
<p>For example, in a generic class <code class="docutils literal notranslate"><span class="pre">List[T]</span></code>, if you create a new instance with
<code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">List[int]()</span></code>, the <code class="docutils literal notranslate"><span class="pre">int</span></code> is the type argument replacing the type parameter
<code class="docutils literal notranslate"><span class="pre">T</span></code> for that specific instance.</p>
<p>Consider the earlier example of the <code class="docutils literal notranslate"><span class="pre">append_and_return_list</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">append_and_return_list</span><span class="p">(</span><span class="n">list_</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">element</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="n">list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">list_</span>
</pre></div>
</div>
<p>When we invoke this function, we supply type arguments through the types of the
arguments passed to the function. If we call <code class="docutils literal notranslate"><span class="pre">append_and_return_list</span></code> with a
list of integers and an integer element:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">list_of_ints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">new_list_of_ints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">append_and_return_list</span><span class="p">(</span><span class="n">list_</span><span class="o">=</span><span class="n">list_of_ints</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, <code class="docutils literal notranslate"><span class="pre">int</span></code> serves as the type argument for <code class="docutils literal notranslate"><span class="pre">T</span></code>. The generic <code class="docutils literal notranslate"><span class="pre">T</span></code> in the
function’s definition is replaced by <code class="docutils literal notranslate"><span class="pre">int</span></code>, making the function operate
specifically on a list of integers. The type argument ensures that the generic
function can be applied to a specific data type, in this context, integers,
thereby tailoring the generic function to a particular use case while preserving
type safety.</p>
</section>
<section id="pair-problem-revisited">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Pair Problem Revisited</a><a class="headerlink" href="#pair-problem-revisited" title="Link to this heading">#</a></h3>
<p>To resolve the issues with the <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class in the motivation, we can use type
variables to parameterize the <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class. This will allow us to specify the
types of the <code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">second</span></code> attributes, as well as the return types of the
<code class="docutils literal notranslate"><span class="pre">get_first</span></code> and <code class="docutils literal notranslate"><span class="pre">get_second</span></code> methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">S</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="nd">@dataclass</span>
<span class="linenos"> 5</span><span class="k">class</span> <span class="nc">Pair</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">]):</span>
<span class="linenos"> 6</span>    <span class="n">first</span><span class="p">:</span> <span class="n">S</span>
<span class="linenos"> 7</span>    <span class="n">second</span><span class="p">:</span> <span class="n">T</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>    <span class="k">def</span> <span class="nf">get_first</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span><span class="p">:</span>
<span class="linenos">10</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="k">def</span> <span class="nf">get_second</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="k">def</span> <span class="nf">create_misleading_pair</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Pair</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span> <span class="c1"># 101: error: Missing type parameters for generic type &quot;Pair&quot;  [type-arg]</span>
<span class="linenos">16</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;This function creates a Pair with a string and an integer.&quot;&quot;&quot;</span>
<span class="linenos">17</span>    <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="k">def</span> <span class="nf">process_misleading_pair</span><span class="p">(</span><span class="n">pair</span><span class="p">:</span> <span class="n">Pair</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">20</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">21</span><span class="sd">    Process elements of the pair, with incorrect assumptions about their types.</span>
<span class="linenos">22</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">23</span>
<span class="linenos">24</span>    <span class="c1"># The programmer incorrectly assumes the first element is an integer</span>
<span class="linenos">25</span>    <span class="c1"># and the second element is a string.</span>
<span class="linenos">26</span>    <span class="k">try</span><span class="p">:</span>
<span class="linenos">27</span>        <span class="n">first_element</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_first</span><span class="p">())</span>  <span class="c1"># Mistakenly assuming it&#39;s an int</span>
<span class="linenos">28</span>        <span class="n">second_element</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_second</span><span class="p">())</span>  <span class="c1"># Mistakenly assuming it&#39;s a str</span>
<span class="linenos">29</span>
<span class="linenos">30</span>        <span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos">31</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_first</span><span class="p">())</span>
<span class="linenos">32</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">pair</span><span class="o">.</span><span class="n">get_second</span><span class="p">())</span>
<span class="linenos">33</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">first_element</span><span class="p">)</span>
<span class="linenos">34</span>            <span class="n">reveal_type</span><span class="p">(</span><span class="n">second_element</span><span class="p">)</span>
<span class="linenos">35</span>            <span class="n">reveal_locals</span><span class="p">()</span>
<span class="linenos">36</span>
<span class="linenos">37</span>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="linenos">38</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="c1"># Example Usage</span>
<span class="linenos">41</span><span class="n">pair</span> <span class="o">=</span> <span class="n">create_misleading_pair</span><span class="p">()</span>
<span class="linenos">42</span><span class="n">process_misleading_pair</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: invalid literal for int() with base 10: &#39;hello&#39;
</pre></div>
</div>
</div>
</div>
<p>To recap:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code> are type variables/parameters that represent the types of the
<code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">second</span></code> attributes, respectively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pair[S,</span> <span class="pre">T]</span></code> is a generic class that is parameterized with <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code>,
allowing the <code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">second</span></code> attributes to be of different types.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pair[str,</span> <span class="pre">int]</span></code> is a parameterized type that represents a pair of a string
and an integer. This just means “subsitution” of <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code> with <code class="docutils literal notranslate"><span class="pre">str</span></code> and
<code class="docutils literal notranslate"><span class="pre">int</span></code> respectively, just like how we assign normal variables.</p></li>
</ul>
<p>However, <code class="docutils literal notranslate"><span class="pre">mypy</span></code> actually does not raise any issue on line <code class="docutils literal notranslate"><span class="pre">27</span></code> because Python
allows a string type to be <em>dynamically converted</em> to an integer type if and
only if the string is a valid “integer” string.</p>
<p>But the example, if set in Java, will allow the type checker to catch the type
mismatch and stop the program from crashing during run-time. Why? Because Java
does not allow a string type to be coerced to an integer type. Below I show a
small snippet of Java code that will raise a <code class="docutils literal notranslate"><span class="pre">ClassCastException</span></code> at run-time.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Main</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Create a String object</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">stringValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Attempt to cast the String to an Integer</span>
<span class="w">        </span><span class="n">Integer</span><span class="w"> </span><span class="n">intValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span><span class="w"> </span><span class="n">stringValue</span><span class="p">;</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">intValue</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="proof example admonition" id="computer-science-type-theory-generics-moot-example">
<p class="admonition-title"><span class="caption-number">Example 12 </span> (I came all the way just for a Moot Example)</p>
<section class="example-content" id="proof-content">
<p>I converted the notes of CS2030S from Java to Python, just to reach a moot point
where the type checker does not raise any issue on line 27. But the point should
be clear. If we do not parameterize the <code class="docutils literal notranslate"><span class="pre">Pair</span></code> class and use <code class="docutils literal notranslate"><span class="pre">Any</span></code> instead, then
even in a strongly typed language like Java, the type mismatch may not be caught
at compile time.</p>
<p>Let’s just construct another simple example where <code class="docutils literal notranslate"><span class="pre">mypy</span></code> will actually raise an
error.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">)</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Pair</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="p">]):</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">K</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">V</span>

    <span class="k">def</span> <span class="nf">get_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">K</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span>

    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

<span class="k">def</span> <span class="nf">log_user_info</span><span class="p">(</span><span class="n">user_info</span><span class="p">:</span> <span class="n">Pair</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logs user information, expecting a username (str) and user ID (int).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">user_info</span><span class="o">.</span><span class="n">get_key</span><span class="p">()</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">user_info</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User: </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">, ID: </span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">create_incorrect_pair</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Pair</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Incorrectly creates a pair intended to represent user info,</span>
<span class="sd">    but swaps the types of the key and value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Mistakenly swapped the order of types, creating a Pair[int, str] instead of Pair[str, int]</span>
    <span class="k">return</span> <span class="n">Pair</span><span class="p">(</span><span class="mi">12345</span><span class="p">,</span> <span class="s2">&quot;john_doe&quot;</span><span class="p">)</span>

<span class="c1"># Example Usage</span>
<span class="n">incorrect_pair</span> <span class="o">=</span> <span class="n">create_incorrect_pair</span><span class="p">()</span>
<span class="n">log_user_info</span><span class="p">(</span><span class="n">user_info</span><span class="o">=</span><span class="n">incorrect_pair</span><span class="p">)</span>
</pre></div>
</div>
<p>Indeed, running <code class="docutils literal notranslate"><span class="pre">mypy</span></code> on the above code will yield:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">33</span>:<span class="w"> </span>error:<span class="w"> </span>Argument<span class="w"> </span><span class="m">1</span><span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;log_user_info&quot;</span><span class="w"> </span>has<span class="w"> </span>incompatible<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s2">&quot;Pair[int, str]&quot;</span><span class="p">;</span><span class="w"> </span>expected<span class="w"> </span><span class="s2">&quot;Pair[str, int]&quot;</span><span class="w">  </span><span class="o">[</span>arg-type<span class="o">]</span>
<span class="w">    </span>log_user_info<span class="o">(</span>incorrect_pair<span class="o">)</span>
</pre></div>
</div>
</section>
</div></section>
</section>
<section id="scope-of-generic-methods-and-functions">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Scope of Generic Methods and Functions</a><a class="headerlink" href="#scope-of-generic-methods-and-functions" title="Link to this heading">#</a></h2>
<p>In the course
<a class="reference external" href="https://nus-cs2030s.github.io/2021-s2/20-generics.html">Unit 20: Generics - CS2030S</a>,
it is written in Java, so there is only mention of generic methods. But in
Python, we can also define generic functions where the function signature and
return type (need not be both) are parameterized by type variables.</p>
<section id="generic-functions">
<span id="computer-science-type-theory-04-generics-generic-functions"></span><h3><a class="toc-backref" href="#id18" role="doc-backlink">Generic Functions</a><a class="headerlink" href="#generic-functions" title="Link to this heading">#</a></h3>
<p>It is possible to use <code class="docutils literal notranslate"><span class="pre">TypeVar</span></code> (type variables) to parameterize the types of
the arguments and return type of a <strong>function</strong> <em>without</em> the need to define a
<code class="docutils literal notranslate"><span class="pre">Generic</span></code> (generic) class. This is because functions are <strong><em>naturally and
automatically</em></strong> scoped to the type variables defined in the function. What does
that mean?</p>
<p>Let’s walk through an example<a class="footnote-reference brackets" href="#id9" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> to find out.</p>
<p>Consider a function that adds two <em>things</em> (not necessarily numbers) together.
In this particular case, if we want to find out the answer of <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">+</span> <span class="pre">4</span></code>, we can
use the <code class="docutils literal notranslate"><span class="pre">add</span></code> function to add <code class="docutils literal notranslate"><span class="pre">3</span></code> and <code class="docutils literal notranslate"><span class="pre">4</span></code> together.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Adding two <em>literal</em> things together is <strong>valid</strong> but <strong>restricted</strong> and
obviously is a bad pattern. Polymorphism taught us to <em>parameterize</em> the the two
<em>things</em> to add:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<p>And injecting <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> is the act of parameterizing the function with what we
call the <strong><em>regular variables</em></strong>.</p>
<p>Now, we want to type hint the <code class="docutils literal notranslate"><span class="pre">add</span></code> function. You may likely do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<p>This is again <strong>valid</strong> but <strong>restricted</strong>. The <code class="docutils literal notranslate"><span class="pre">add</span></code> function is now restricted
to adding two integers together. What if we want to add two strings together?
What if we want to add two floats together? What if we want to add two <code class="docutils literal notranslate"><span class="pre">Item</span></code>
objects with <code class="docutils literal notranslate"><span class="pre">__add__</span></code> method defined together?</p>
<p>This is where you would consider using <strong><em>type variables</em></strong> to parameterize the
types of the arguments and return type of the function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<p>This means that <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> can be of any type, and the return type of the
function will be the same as the type of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>. A contract is born because
now if <code class="docutils literal notranslate"><span class="pre">x</span></code> is defined as an <code class="docutils literal notranslate"><span class="pre">int</span></code> type, then <code class="docutils literal notranslate"><span class="pre">y</span></code> must also be an <code class="docutils literal notranslate"><span class="pre">int</span></code> type, and
the return type of the function will be an <code class="docutils literal notranslate"><span class="pre">int</span></code> type.</p>
<p>Note however, running mypy above will yield two particular errors:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">4</span>:<span class="w"> </span>error:<span class="w"> </span>Returning<span class="w"> </span>Any<span class="w"> </span>from<span class="w"> </span><span class="k">function</span><span class="w"> </span>declared<span class="w"> </span>to<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;T&quot;</span><span class="w">  </span><span class="o">[</span>no-any-return<span class="o">]</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span>x<span class="w"> </span>+<span class="w"> </span>y
<span class="w">        </span>^~~~~~~~~~~~
<span class="m">4</span>:<span class="w"> </span>error:<span class="w"> </span>Unsupported<span class="w"> </span>left<span class="w"> </span>operand<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>+<span class="w"> </span><span class="o">(</span><span class="s2">&quot;T&quot;</span><span class="o">)</span><span class="w">  </span><span class="o">[</span>operator<span class="o">]</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span>x<span class="w"> </span>+<span class="w"> </span>y
<span class="w">               </span>^~~~~
</pre></div>
</div>
<p>This is because there is no guarantee that the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator is defined for the
type <code class="docutils literal notranslate"><span class="pre">T</span></code>. What if <code class="docutils literal notranslate"><span class="pre">T</span></code> is a <code class="docutils literal notranslate"><span class="pre">Dict[int,</span> <span class="pre">int]</span></code> type, then adding two dictionaries
together is not defined (likely no <code class="docutils literal notranslate"><span class="pre">__add__</span></code> method defined for the <code class="docutils literal notranslate"><span class="pre">dict</span></code>
type). But let’s ignore this and appreciate the bigger picture.</p>
<p>We will talk about bound and constraints later, which will easily solve this
problem:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="c1"># yields no error from mypy</span>
</pre></div>
</div>
<p>In conclusion, the <code class="docutils literal notranslate"><span class="pre">add</span></code> function is now a <strong><em>generic function</em></strong> because it can
operate on any type of object, and the type of the arguments and return type of
the function are parameterized by type variables. But note that the type
variables are <strong>only</strong> scoped to the function, and they are not available
outside the function.</p>
</section>
<section id="generic-methods">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Generic Methods</a><a class="headerlink" href="#generic-methods" title="Link to this heading">#</a></h3>
<p>In the context of classes, it is also possible to define <strong><em>generic methods</em></strong>
where the method signature and return type (need not both) are parameterized by
type variables.</p>
<p>We first look at another violation of type safety via the <code class="docutils literal notranslate"><span class="pre">Stack</span></code> class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">TypeVar</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">rich.pretty</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="k">class</span> <span class="nc">Stack</span><span class="p">:</span>
<span class="linenos"> 7</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 8</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">11</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># __contains__ method</span>
<span class="linenos">14</span>        <span class="k">for</span> <span class="n">curr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">:</span>
<span class="linenos">15</span>            <span class="k">if</span> <span class="n">curr</span> <span class="o">==</span> <span class="n">item</span><span class="p">:</span>
<span class="linenos">16</span>                <span class="k">return</span> <span class="kc">True</span>
<span class="linenos">17</span>        <span class="k">return</span> <span class="kc">False</span>
<span class="linenos">18</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="n">stack</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">()</span>
<span class="linenos">21</span><span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s2">&quot;world&quot;</span><span class="p">)</span>
<span class="linenos">23</span><span class="n">pprint</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">_container</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'hello'</span>, <span style="color: #008000; text-decoration-color: #008000">'world'</span><span style="font-weight: bold">]</span>
</pre>
</div></div>
</div>
<p>As you can see, the <code class="docutils literal notranslate"><span class="pre">contains</span></code> method is not type safe. The <code class="docutils literal notranslate"><span class="pre">item</span></code> parameter is
of type <code class="docutils literal notranslate"><span class="pre">Any</span></code>, and the method will return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the <code class="docutils literal notranslate"><span class="pre">item</span></code> is found in the
stack. The problem with <code class="docutils literal notranslate"><span class="pre">Any</span></code>, as repeated many times, is that it is too generic
and does not provide a contract to abide by. For example, our stack above as we
see it, contains strings, and only strings. Now if we want to search for an
integer <code class="docutils literal notranslate"><span class="pre">to_find</span> <span class="pre">=</span> <span class="pre">123</span></code> in the stack, the <code class="docutils literal notranslate"><span class="pre">contains</span></code> method will return <code class="docutils literal notranslate"><span class="pre">False</span></code>
because the <code class="docutils literal notranslate"><span class="pre">item</span></code> is not found in the stack. The problem is that the integer
type will never be found in the stack because the stack only contains strings.
However, because both the <code class="docutils literal notranslate"><span class="pre">self._container</span></code> and <code class="docutils literal notranslate"><span class="pre">item</span></code> are of type <code class="docutils literal notranslate"><span class="pre">Any</span></code>, the
type checker will not raise any error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">to_find</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span>
<span class="linenos">2</span><span class="n">result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">to_find</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #ff0000; text-decoration-color: #ff0000; font-style: italic">False</span>
</pre>
</div></div>
</div>
<p>We want to bind a contract such that if the <code class="docutils literal notranslate"><span class="pre">self._container</span></code> is of type
<code class="docutils literal notranslate"><span class="pre">List[str]</span></code>, then the <code class="docutils literal notranslate"><span class="pre">item</span></code> must also be of type <code class="docutils literal notranslate"><span class="pre">str</span></code>. If the
<code class="docutils literal notranslate"><span class="pre">self._container</span></code> is of type <code class="docutils literal notranslate"><span class="pre">List[int]</span></code>, then the <code class="docutils literal notranslate"><span class="pre">item</span></code> must also be of type
<code class="docutils literal notranslate"><span class="pre">int</span></code>. This is where we can use type variables to parameterize the types of the
arguments and return type of the method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">TypeVar</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">rich.pretty</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="k">class</span> <span class="nc">Stack</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
<span class="linenos"> 9</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">10</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">11</span>
<span class="linenos">12</span>    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># __contains__ method</span>
<span class="linenos">16</span>        <span class="k">for</span> <span class="n">curr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">:</span>
<span class="linenos">17</span>            <span class="k">if</span> <span class="n">curr</span> <span class="o">==</span> <span class="n">item</span><span class="p">:</span>
<span class="linenos">18</span>                <span class="k">return</span> <span class="kc">True</span>
<span class="linenos">19</span>        <span class="k">return</span> <span class="kc">False</span>
<span class="linenos">20</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="n">stack_of_strings</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">[</span><span class="nb">str</span><span class="p">]()</span>
<span class="linenos">23</span><span class="n">stack_of_strings</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="linenos">24</span><span class="n">stack_of_strings</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s2">&quot;world&quot;</span><span class="p">)</span>
<span class="linenos">25</span><span class="n">pprint</span><span class="p">(</span><span class="n">stack_of_strings</span><span class="o">.</span><span class="n">_container</span><span class="p">)</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="n">to_find</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span>
<span class="linenos">28</span><span class="n">result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">stack_of_strings</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">to_find</span><span class="p">)</span> <span class="c1"># error from mypy</span>
<span class="linenos">29</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="n">to_find</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hello&quot;</span>
<span class="linenos">32</span><span class="n">result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">stack_of_strings</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">to_find</span><span class="p">)</span> <span class="c1"># no error from mypy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'hello'</span>, <span style="color: #008000; text-decoration-color: #008000">'world'</span><span style="font-weight: bold">]</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #ff0000; text-decoration-color: #ff0000; font-style: italic">False</span>
</pre>
</div></div>
</div>
<p>Notably, if we define the <code class="docutils literal notranslate"><span class="pre">Stack</span></code> class as <code class="docutils literal notranslate"><span class="pre">Stack[str]</span></code>, then the <code class="docutils literal notranslate"><span class="pre">T</span></code> is now
bound to <code class="docutils literal notranslate"><span class="pre">str</span></code>. This means that any type hints in the <code class="docutils literal notranslate"><span class="pre">Stack</span></code> class that uses
<code class="docutils literal notranslate"><span class="pre">T</span></code> will now be bound to <code class="docutils literal notranslate"><span class="pre">str</span></code>. This would include the <code class="docutils literal notranslate"><span class="pre">item</span></code> parameter in the
<code class="docutils literal notranslate"><span class="pre">contains</span></code> method. Consequently, the above code will actually yield an error
from <code class="docutils literal notranslate"><span class="pre">mypy</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">28</span>:<span class="w"> </span>error:<span class="w"> </span>Argument<span class="w"> </span><span class="m">1</span><span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;contains&quot;</span><span class="w"> </span>of<span class="w"> </span><span class="s2">&quot;Stack&quot;</span><span class="w"> </span>has<span class="w"> </span>incompatible<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="p">;</span><span class="w"> </span>expected<span class="w"> </span><span class="s2">&quot;str&quot;</span><span class="w">  </span><span class="o">[</span>arg-type<span class="o">]</span>
<span class="w">    </span>result:<span class="w"> </span><span class="nv">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>stack.contains<span class="o">(</span>to_find<span class="o">)</span>
</pre></div>
</div>
<p>Similarly, you can define the <code class="docutils literal notranslate"><span class="pre">Stack</span></code> class as <code class="docutils literal notranslate"><span class="pre">Stack[int]</span></code>, and the <code class="docutils literal notranslate"><span class="pre">T</span></code> is now
bound to <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p>
<p>The above example <strong>scopes</strong> the type variable <code class="docutils literal notranslate"><span class="pre">T</span></code> to the <code class="docutils literal notranslate"><span class="pre">Stack</span></code> class in its
entirety. Unlike functions, creating a generic class does not automatically
scope the type variables across attributes and methods. You have to explicitly
define the type hints yourself. Consequently, it is not uncommon to only scope
the type variable to some attributes and methods to the generic class. How you
scope them depends on the use cases.</p>
</section>
</section>
<section id="references-and-further-readings">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">References and Further Readings</a><a class="headerlink" href="#references-and-further-readings" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.playfulpython.com/python-type-hinting-generics-inheritance/">Type Hinting: Generics &amp; Inheritance</a></p></li>
<li><p><a class="reference external" href="https://nus-cs2030s.github.io/2021-s2/20-generics.html">Unit 20: Generics - CS2030S</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#generics">Generics - Python Docs</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#user-defined-generic-types">User-defined generic types - Python Docs</a></p></li>
<li><p><a class="reference external" href="https://stackoverflow.com/questions/68739824/use-of-generic-and-typevar">Use of Generic and TypeVar</a></p></li>
<li><p><a class="reference external" href="https://www.gaohongnan.com/dsa/stack/concept.html#the-importance-of-generic-types">Stack - Omniverse</a></p></li>
<li><p><a class="reference external" href="https://nus-cs2030s.github.io/2021-s2/21-erasure.html">Implementing Generics via Type Erasure - CS2030S</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=LcfxUU1A-RQ">python Generics (intermediate) anthony explains #430</a></p></li>
<li><p><a class="reference external" href="https://peps.python.org/pep-0484/#scoping-rules-for-type-variables">Scoping rules for type variables</a></p></li>
<li><p><a class="reference external" href="https://peps.python.org/pep-0483/">PEP 483 – The Theory of Type Hints</a></p></li>
<li><p><a class="reference external" href="https://peps.python.org/pep-0484/">PEP 484 – Type Hints</a></p></li>
</ul>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.playfulpython.com/python-type-hinting-generics-inheritance/">Type Hinting: Generics &amp; Inheritance</a></p>
</aside>
<aside class="footnote brackets" id="id7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://nus-cs2030s.github.io/2021-s2/20-generics.html">Unit 20: Generics - CS2030S</a></p>
</aside>
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://peps.python.org/pep-0483/#generic-types">PEP 483 – The Theory of Type Hints</a></p>
</aside>
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">4</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://stackoverflow.com/questions/68739824/use-of-generic-and-typevar">Use of Generic and TypeVar</a></p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./computer_science/type_theory"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="03-subsumption.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Subsumption</p>
      </div>
    </a>
    <a class="right-next"
       href="05-typevar-bound-constraints.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Bound and Constraint in Generics and Type Variables</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-motivation">The Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#containers-are-generics">Containers are Generics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Generics and Type Variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generics">Generics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-variable-and-type-parameter">Type Variable and Type Parameter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-argument">Type Argument</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pair-problem-revisited">Pair Problem Revisited</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scope-of-generic-methods-and-functions">Scope of Generic Methods and Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-functions">Generic Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-methods">Generic Methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references-and-further-readings">References and Further Readings</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gao Hongnan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>