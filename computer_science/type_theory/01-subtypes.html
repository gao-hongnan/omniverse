
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Subtypes &#8212; Omniverse</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=bb35926c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-MYW5YKC2WF"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MYW5YKC2WF');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MYW5YKC2WF');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'computer_science/type_theory/01-subtypes';</script>
    <link rel="canonical" href="https://www.gaohongnan.com/computer_science/type_theory/01-subtypes.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Type Safety" href="02-type-safety.html" />
    <link rel="prev" title="Type Theory, A Very Rudimentary Introduction" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Omniverse - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Omniverse - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    ðŸŒŒ Omniverse: A Journey Through Knowledge
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Notations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notations/machine_learning.html">Machine Learning Notations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Influential Ideas and Papers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../influential/generative_pretrained_transformer/01_intro.html">Generative Pre-trained Transformers</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../influential/generative_pretrained_transformer/02_notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../influential/generative_pretrained_transformer/03_concept.html">The Concept of Generative Pre-trained Transformers (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../influential/generative_pretrained_transformer/04_implementation.html">The Implementation of Generative Pre-trained Transformers (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../influential/generative_pretrained_transformer/05_adder.html">Training a Mini-GPT to Learn Two-Digit Addition</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Playbook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../playbook/how_to_calculate_flops_in_gpt2.html">How to Calculate the Number of FLOPs in GPT-2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playbook/how_to_inspect_function_and_class_signatures.html">How to Inspect Function and Class Signatures in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playbook/why_cosine_annealing_warmup_stabilize_training.html">Why Does Cosine Annealing With Warmup Stabilize Training?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playbook/why_softmax_preserves_order_translation_invariant_not_invariant_scaling.html">Softmax Preserves Order, Is Translation Invariant But Not Invariant Under Scaling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deep Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../deep_learning/training_chronicles/intro.html">Training Chronicles</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../deep_learning/training_chronicles/loss.html">The Loss Landscape</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Software Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../software_engineering/devops/continuous-integration/concept.html">Continuous Integration (CI) Workflow</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/devops/continuous-integration/styling.html">Styling, Formatting, and Linting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/devops/continuous-integration/testing.html">Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../software_engineering/design_patterns/dependency-inversion-principle.html">Dependency Inversion Principle</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../software_engineering/concurrency_parallelism_asynchronous/intro.html">Concurrency, Parallelism and Asynchronous Programming</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/concurrency_parallelism_asynchronous/generator_yield.html">A Rudimentary Introduction to Generator and Yield in Python</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../software_engineering/serving/restful_api/intro.html">RESTful API</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../software_engineering/serving/restful_api/application_banking.html">Application: Designing a RESTful Banking API with FastAPI and SQLAlchemy</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Science</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Type Theory, A Very Rudimentary Introduction</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Subtypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-type-safety.html">Type Safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-subsumption.html">Subsumption</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-generics.html">Generics and Type Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-typevar-bound-constraints.html">Bound and Constraint in Generics and Type Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-invariance-covariance-contravariance.html">Invariance, Covariance and Contravariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-pep-3124-overloading.html">Function Overloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="08-pep-661-sentinel-values.html">Sentinel Types</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Structures and Algorithms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/complexity_analysis/intro.html">Complexity Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/complexity_analysis/master_theorem.html">Master Theorem </a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/stack/intro.html">Stack</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/stack/concept.html">Concept</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/searching_algorithms/linear_search/intro.html">Linear Search</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/searching_algorithms/linear_search/concept.html">Concept</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dsa/searching_algorithms/binary_search/intro.html">Binary Search</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/searching_algorithms/binary_search/concept.html">Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dsa/searching_algorithms/binary_search/problems/875-koko-eating-bananas.html">Koko Eating Bananas</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Algebra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../linear_algebra/01_preliminaries/intro.html">Preliminaries</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/01_preliminaries/01-fields.html">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/01_preliminaries/02-systems-of-linear-equations.html">Systems of Linear Equations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../linear_algebra/02_vectors/intro.html">Vectors</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/01-vector-definition.html">Vector and Its Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/02-vector-operation.html">Vector and Its Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/03-vector-norm.html">Vector Norm and Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linear_algebra/02_vectors/04-vector-products.html">A First Look at Vector Products</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Operations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../operations/machine_learning_lifecycle/00_intro.html">The Lifecycle of an AIOps System</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../operations/machine_learning_lifecycle/01_problem_formulation.html">Stage 1. Problem Formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/machine_learning_lifecycle/02_project_scoping.html">Stage 2. Project Scoping And Framing The Problem</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../operations/machine_learning_lifecycle/03_dataops_pipeline.html">Stage 3. Data Pipeline (Data Engineering and DataOps)</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/031_data_source_and_format.html">Stage 3.1. Data Source and Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/032_data_model_and_storage.html">Stage 3.2. Data Model and Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../operations/machine_learning_lifecycle/033_etl.html">Stage 3.3. Extract, Transform, Load (ETL)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References, Resources and Roadmap</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citations.html">IEEE (Style) Citations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../api/reproducibility.html">API Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/gao-hongnan/omniverse/blob/main/omniverse/computer_science/type_theory/01-subtypes.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/gao-hongnan/omniverse" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gao-hongnan/omniverse/issues/new?title=Issue%20on%20page%20%2Fcomputer_science/type_theory/01-subtypes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/computer_science/type_theory/01-subtypes.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../_sources/computer_science/type_theory/01-subtypes.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Subtypes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-are-sets">Types are Sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nominal-vs-structural-subtyping">Nominal vs. Structural Subtyping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nominal-subtyping-class-hierarchy-determines-subtypes">Nominal Subtyping - Class Hierarchy Determines Subtypes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-nominal-subtyping">What is Nominal Subtyping?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-nominal-subtyping">Why Nominal Subtyping?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-implement-nominal-subtyping">How to Implement Nominal Subtyping?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structural-subtyping">Structural Subtyping</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-structural-subtyping">What is Structural Subtyping?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-structural-subtyping">Why Structural Subtyping?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-implement-structural-subtyping">How to Implement Structural Subtyping?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pros-and-cons-of-nominal-and-structural-subtyping">Pros and Cons of Nominal and Structural Subtyping</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusive-vs-coercive-implementations">Inclusive vs. Coercive Implementations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusive-implementations">Inclusive Implementations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coercive-implementations">Coercive Implementations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references-and-further-readings">References and Further Readings</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="subtypes">
<h1>Subtypes<a class="headerlink" href="#subtypes" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://twitter.com/gaohongnan"><img alt="Twitter Handle" src="https://img.shields.io/badge/Twitter-&#64;gaohongnan-blue?style=social&amp;logo=twitter" /></a>
<a class="reference external" href="https://linkedin.com/in/gao-hongnan"><img alt="LinkedIn Profile" src="https://img.shields.io/badge/&#64;gaohongnan-blue?style=social&amp;logo=linkedin" /></a>
<a class="reference external" href="https://github.com/gao-hongnan"><img alt="GitHub Profile" src="https://img.shields.io/badge/GitHub-gao--hongnan-lightgrey?style=social&amp;logo=github" /></a>
<img alt="Tag" src="https://img.shields.io/badge/Tag-Structured_Musings-purple" />
<img alt="Tag" src="https://img.shields.io/badge/Level-Beginner-green" />
<img alt="Tag" src="https://img.shields.io/badge/Tag-Vetted-green" /></p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#types-are-sets" id="id5">Types are Sets</a></p></li>
<li><p><a class="reference internal" href="#nominal-vs-structural-subtyping" id="id6">Nominal vs. Structural Subtyping</a></p>
<ul>
<li><p><a class="reference internal" href="#nominal-subtyping-class-hierarchy-determines-subtypes" id="id7">Nominal Subtyping - Class Hierarchy Determines Subtypes</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-nominal-subtyping" id="id8">What is Nominal Subtyping?</a></p></li>
<li><p><a class="reference internal" href="#why-nominal-subtyping" id="id9">Why Nominal Subtyping?</a></p></li>
<li><p><a class="reference internal" href="#how-to-implement-nominal-subtyping" id="id10">How to Implement Nominal Subtyping?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#structural-subtyping" id="id11">Structural Subtyping</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-structural-subtyping" id="id12">What is Structural Subtyping?</a></p></li>
<li><p><a class="reference internal" href="#why-structural-subtyping" id="id13">Why Structural Subtyping?</a></p></li>
<li><p><a class="reference internal" href="#how-to-implement-structural-subtyping" id="id14">How to Implement Structural Subtyping?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#pros-and-cons-of-nominal-and-structural-subtyping" id="id15">Pros and Cons of Nominal and Structural Subtyping</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#inclusive-vs-coercive-implementations" id="id16">Inclusive vs. Coercive Implementations</a></p>
<ul>
<li><p><a class="reference internal" href="#inclusive-implementations" id="id17">Inclusive Implementations</a></p></li>
<li><p><a class="reference internal" href="#coercive-implementations" id="id18">Coercive Implementations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#references-and-further-readings" id="id19">References and Further Readings</a></p></li>
</ul>
</nav>
<p>In
<a class="reference external" href="https://en.wikipedia.org/wiki/Programming_language_theory">programming language theory</a>,
<a class="reference external" href="https://en.wikipedia.org/wiki/Subtyping"><strong>subtyping</strong></a> (also called subtype
polymorphism or inclusion polymorphism) is a form of
<a class="reference external" href="https://en.wikipedia.org/wiki/Polymorphism_(computer_science)">type polymorphism</a>.
A subtype is a datatype that is related to another datatype (the supertype) by
some notion of
<a class="reference external" href="https://en.wikipedia.org/wiki/Substitutability">substitutability</a> (read:
<a class="reference external" href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov substitution principle</a>),
meaning that program elements (typically
<a class="reference external" href="https://en.wikipedia.org/wiki/Subroutines">subroutines</a> or
<a class="reference external" href="https://en.wikipedia.org/wiki/Function_(computer_programming)">functions</a>),
written to operate on elements of the supertype, can also operate on elements of
the subtype<a class="footnote-reference brackets" href="#subtype-wikipedia" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<section id="types-are-sets">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Types are Sets</a><a class="headerlink" href="#types-are-sets" title="Link to this heading">#</a></h2>
<p>For people coming from a mathematical background, it may be useful to think of
types as <a class="reference external" href="https://en.wikipedia.org/wiki/Set_(mathematics)">sets</a>. Indeed, a
type in the context of type theory, <em>is a</em> set of
values<a class="footnote-reference brackets" href="#subtype-subsumption-wikipedia" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. In essence, a type defines a
collectionâ€”or setâ€”of values that share certain characteristics.</p>
<div class="proof example admonition" id="type-theory-01-subtypes-example-int-type-as-set">
<p class="admonition-title"><span class="caption-number">Example 4 </span> (Integer Type as a Set)</p>
<section class="example-content" id="proof-content">
<p>To illustrate, consider the <strong>Integer</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code>) type in many programming
languages. You can think of this type as a set that includes all whole numbers
from negative infinity to positive infinity. Each number in this set ranging
from <span class="math notranslate nohighlight">\(-\infty\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span> is an <strong>element</strong> of the <strong>Integer</strong> type.</p>
</section>
</div></section>
<section id="nominal-vs-structural-subtyping">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Nominal vs. Structural Subtyping</a><a class="headerlink" href="#nominal-vs-structural-subtyping" title="Link to this heading">#</a></h2>
<p>In type theory, a crucial distinction is made between two primary subtyping
schemes:
<a class="reference external" href="https://en.wikipedia.org/wiki/Nominal_type_system"><strong><em>nominal subtyping</em></strong></a> and
<a class="reference external" href="https://en.wikipedia.org/wiki/Structural_type_system"><strong><em>structural subtyping</em></strong></a>.
This distinction is fundamental in understanding how different programming
languages conceptualize and implement <strong>subtype relationships</strong>. <strong><em>Nominal
subtyping</em></strong> bases the subtype relationship on <strong>explicit declarations</strong> (like
class inheritance), while <strong><em>structural subtyping</em></strong> determines it based on the
actual <strong>structure</strong> (methods and properties) of the types.</p>
<p>This distinction is particularly important for static type checkers, which
checks the types at
<a class="reference external" href="https://stackoverflow.com/questions/71616237/in-general-static-languages-are-type-checked-at-compile-time-is-typescript-als"><strong>compile time</strong></a>,
and rely on the subtyping schemes to determine if one type, <span class="math notranslate nohighlight">\(\mathcal{A}\)</span>, is a
subtype of another type, <span class="math notranslate nohighlight">\(\mathcal{B}\)</span>.</p>
<p>In <strong>nominal subtyping</strong>, the static type checker searches for <strong><em>explicit
declarations of inheritance</em></strong> (e.g., class <code class="docutils literal notranslate"><span class="pre">A</span></code> extends <code class="docutils literal notranslate"><span class="pre">B</span></code>), clearly indicating
that <code class="docutils literal notranslate"><span class="pre">A</span></code> is a subtype of <code class="docutils literal notranslate"><span class="pre">B</span></code>. This establishes a formal, name-based relationship
between types at the time of declaration which means that this schema relies
more on the declared hierarchy and naming of the types rather than their
inherent structure or functionalities. Conversely, <strong>structural subtyping</strong>
involves the checker assessing whether a potential subtype possesses all
necessary <strong><em>structural features, such as methods and properties</em></strong>, to fulfill
the requirements of its supertype, <em>without</em> requiring any explicit declaration
of this relationship. For instance, the checker would examine if the subtype
implements all the <em>methods</em> present in the supertype, ensuring <em>compatibility</em>
based solely on structural <em>characteristics</em>.</p>
<div class="note admonition">
<p class="admonition-title">Declaration, Compile, and Run Time</p>
<p><strong>Nominal subtype relationships</strong> are established at <strong>declaration time</strong> (i.e.,
when a new subclass is declared), and checked at <strong>compile time</strong>, whereas
<strong>structural subtype relationships</strong> are established at the <strong>point of use</strong>,
and checked at <strong>runtime</strong>. However, when defining via <code class="docutils literal notranslate"><span class="pre">mypy</span></code>â€™s <code class="docutils literal notranslate"><span class="pre">Protocol</span></code>,
the structural subtyping is actually checked at <strong>compile time</strong>. We will see
the difference later.</p>
</div>
<section id="nominal-subtyping-class-hierarchy-determines-subtypes">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Nominal Subtyping - Class Hierarchy Determines Subtypes</a><a class="headerlink" href="#nominal-subtyping-class-hierarchy-determines-subtypes" title="Link to this heading">#</a></h3>
<p>Given the backdrop in the previous section, we would condense out the key
concepts of nominal subtyping below, and end it off with a python example.</p>
<section id="what-is-nominal-subtyping">
<h4><a class="toc-backref" href="#id8" role="doc-backlink">What is Nominal Subtyping?</a><a class="headerlink" href="#what-is-nominal-subtyping" title="Link to this heading">#</a></h4>
<p><strong><em>Nominal subtyping</em></strong> is a type system concept where a type is considered a
subtype of another <strong>only if it is explicitly declared as such</strong>. This mechanism
is rooted in <strong>explicit declarations</strong> of type relationships, typically through
class inheritance in object-oriented programming languages.</p>
</section>
<section id="why-nominal-subtyping">
<h4><a class="toc-backref" href="#id9" role="doc-backlink">Why Nominal Subtyping?</a><a class="headerlink" href="#why-nominal-subtyping" title="Link to this heading">#</a></h4>
<p>Nominal subtyping provides a <strong>controlled environment for polymorphism</strong>, where
the relationships between types are <strong>well-defined</strong> and <strong>restricted according
to the class hierarchy</strong>. Consequently, the <em>explicitness</em> of such declaration
provides clarity to developers. Furthermore, nominal subtype relationships need
to be planned in advance, and hence it might be easier to ensure that certain
principles (e.g, the Liskov substitution principle) hold for subtypes.</p>
</section>
<section id="how-to-implement-nominal-subtyping">
<h4><a class="toc-backref" href="#id10" role="doc-backlink">How to Implement Nominal Subtyping?</a><a class="headerlink" href="#how-to-implement-nominal-subtyping" title="Link to this heading">#</a></h4>
<p>In languages that utilize <strong><em>nominal subtyping</em></strong>, <strong>subclassing</strong> or
<strong>interface implementation</strong> are the primary means to establish subtype
relationships. For instance, a class must <strong>explicitly extend another class</strong> or
<strong>implement an interface</strong> to be considered its subtype. This approach relies on
the <strong>lineage of type declarations</strong> to determine subtype relationships,
focusing on <strong>names and declarations</strong> rather than the structural content of the
types.</p>
<p>In Java for instance, if <code class="docutils literal notranslate"><span class="pre">class</span> <span class="pre">Dog</span> <span class="pre">extends</span> <span class="pre">Animal</span></code>, <strong><em>Dog</em></strong> is a <strong><em>nominal
subtype</em></strong> of <strong><em>Animal</em></strong> because it <strong>explicitly extends</strong> <code class="docutils literal notranslate"><span class="pre">Animal</span></code>. We see a
similar implementation in Python below, detailing how <code class="docutils literal notranslate"><span class="pre">Dog</span></code> and <code class="docutils literal notranslate"><span class="pre">Cat</span></code> are both
subtypes of their parent class <code class="docutils literal notranslate"><span class="pre">Animal</span></code> through inheritance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">Animal</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 3</span>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">make_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 6</span>        <span class="k">return</span> <span class="s2">&quot;Generic Animal Sound!&quot;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
<span class="linenos">10</span>    <span class="k">def</span> <span class="nf">make_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">11</span>        <span class="k">return</span> <span class="s2">&quot;Woof!&quot;</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="k">def</span> <span class="nf">fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">14</span>        <span class="k">return</span> <span class="s2">&quot;Happily fetching balls!&quot;</span>
<span class="linenos">15</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
<span class="linenos">18</span>    <span class="k">def</span> <span class="nf">make_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">19</span>        <span class="k">return</span> <span class="s2">&quot;Meow&quot;</span>
<span class="linenos">20</span>
<span class="linenos">21</span>    <span class="k">def</span> <span class="nf">how_many_lives</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">22</span>        <span class="k">return</span> <span class="s2">&quot;I have 9 lives!&quot;</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="k">class</span> <span class="nc">Robot</span><span class="p">:</span>
<span class="linenos">25</span>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">26</span>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span>    <span class="k">def</span> <span class="nf">make_sound</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">29</span>        <span class="k">return</span> <span class="s2">&quot;Generic Robot Sound!&quot;</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="n">cat</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">()</span>
<span class="linenos">32</span><span class="n">dog</span> <span class="o">=</span> <span class="n">Dog</span><span class="p">()</span>
<span class="linenos">33</span><span class="n">rob</span> <span class="o">=</span> <span class="n">Robot</span><span class="p">()</span>
<span class="linenos">34</span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="n">Animal</span><span class="p">))</span>  <span class="c1"># True,  Cat is a nominal subtype of Animal</span>
<span class="linenos">35</span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dog</span><span class="p">,</span> <span class="n">Animal</span><span class="p">))</span>  <span class="c1"># True,  Dog is a nominal subtype of Animal</span>
<span class="linenos">36</span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">rob</span><span class="p">,</span> <span class="n">Animal</span><span class="p">))</span>  <span class="c1"># False, Robit is not a nominal subtype of Animal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
True
False
</pre></div>
</div>
</div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">Dog</span></code> and <code class="docutils literal notranslate"><span class="pre">Cat</span></code> are nominal subtypes of <code class="docutils literal notranslate"><span class="pre">Animal</span></code> because they
explicitly inherit from the <code class="docutils literal notranslate"><span class="pre">Animal</span></code> class. However, <code class="docutils literal notranslate"><span class="pre">Robot</span></code> which has the exact
same methods as <code class="docutils literal notranslate"><span class="pre">Animal</span></code>, is not a subclass of <code class="docutils literal notranslate"><span class="pre">Animal</span></code> and therefore do not
qualify as a subtype of <code class="docutils literal notranslate"><span class="pre">Animal</span></code> under the nominal subtyping framework. Note
that python allows unsafe overriding of attributes and methods, so we really
want static type checker to ensure we do not violate any rules such as
<a class="reference external" href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov Substitution Principle</a>.</p>
</section>
</section>
<section id="structural-subtyping">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Structural Subtyping</a><a class="headerlink" href="#structural-subtyping" title="Link to this heading">#</a></h3>
<section id="what-is-structural-subtyping">
<h4><a class="toc-backref" href="#id12" role="doc-backlink">What is Structural Subtyping?</a><a class="headerlink" href="#what-is-structural-subtyping" title="Link to this heading">#</a></h4>
<p><strong><em>Structural subtyping</em></strong> is a type system strategy where a type is considered
a subtype of another based on its <strong>structure</strong> â€” specifically, if it possesses
all the <strong>members</strong> (properties and methods) required by the supertype. This
approach contrasts with nominal subtyping by focusing on the capabilities of
types rather than their explicit declarations or lineage. It aligns with the
concept of â€œ<a class="reference external" href="https://en.wikipedia.org/wiki/Duck_typing">duck typing</a>â€ in
dynamically typed languages: if an object behaves like a duck (implements all
the duck behaviors), it can be treated as a duck</p>
</section>
<section id="why-structural-subtyping">
<h4><a class="toc-backref" href="#id13" role="doc-backlink">Why Structural Subtyping?</a><a class="headerlink" href="#why-structural-subtyping" title="Link to this heading">#</a></h4>
<p>The flexibility of structural subtyping allows for <strong>novel and unintended uses</strong>
of existing code by enabling objects that do not share a common inheritance path
to interact seamlessly as long as they fulfill the structural criteria.
Sometimes you would like to enable loose coupling and subclass (nominal) may
just add unwanted complexity.</p>
<p>Consider a toy example below, where we construct <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> to hold a <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>
containing elements of type <code class="docutils literal notranslate"><span class="pre">T</span></code>. The current implementation does not have any
subtyping schemes to it, and therefore, if we try to check if this <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> is
an instance of
<a class="reference external" href="https://github.com/python/cpython/blob/15309329b65a285cb7b3071f0f08ac964b61411b/Lib/_collections_abc.py#L399"><code class="docutils literal notranslate"><span class="pre">Sized</span></code></a>,
we would get <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="linenos">2</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="k">class</span> <span class="nc">Dataset</span><span class="p">:</span>
<span class="linenos">5</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">6</span>        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span>
<span class="linenos">7</span>
<span class="linenos">8</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="linenos">9</span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">Sized</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>However, once we add <code class="docutils literal notranslate"><span class="pre">__len__</span></code> to the example, then <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> is now an instance
of the <code class="docutils literal notranslate"><span class="pre">Sized</span></code>. The Sized protocol requires just one thing: a <code class="docutils literal notranslate"><span class="pre">__len__</span></code> method
that returns the size of the container. Despite Dataset not inheriting from any
specific class that implements Sized, the mere presence of the said method
adheres to the structural expectations of being â€œsizableâ€.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">Dataset</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 3</span>        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">elements</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="linenos"> 6</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of elements in the collection.&quot;&quot;&quot;</span>
<span class="linenos"> 7</span>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="linenos">10</span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">Sized</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>It is worth noting that the <code class="docutils literal notranslate"><span class="pre">Sized</span></code> protocol is not really the <code class="docutils literal notranslate"><span class="pre">Protocol</span></code> we
know of, instead they use <code class="docutils literal notranslate"><span class="pre">__subclasshook__</span></code> for the <strong><em>structural typing dark
magic</em></strong> to happen.</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>class Sized(metaclass=ABCMeta):
<span class="linenos"> 2</span>
<span class="linenos"> 3</span>    <span class="gs">__slots__</span> = ()
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>    <span class="ni">@abstractmethod</span>
<span class="linenos"> 6</span>    def <span class="gs">__len__</span>(self):
<span class="linenos"> 7</span>        return 0
<span class="linenos"> 8</span>
<span class="hll"><span class="linenos"> 9</span>    <span class="ni">@classmethod</span>
</span><span class="hll"><span class="linenos">10</span>    def <span class="gs">__subclasshook__</span>(cls: Type[Sized], C: Type) -&gt; bool:
</span><span class="hll"><span class="linenos">11</span>        if cls is Sized:
</span><span class="hll"><span class="linenos">12</span>            return <span class="ge">_check_</span>methods(C, &quot;<span class="gs">__len__</span>&quot;)
</span><span class="hll"><span class="linenos">13</span>        return NotImplemented
</span></pre></div>
</div>
<p>To this end, the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> class is now a structural subtype of the <code class="docutils literal notranslate"><span class="pre">Sized</span></code>
class, as it implements the <code class="docutils literal notranslate"><span class="pre">__len__</span></code> method required by the <code class="docutils literal notranslate"><span class="pre">Sized</span></code> â€œprotocolâ€.
The check is done at <strong>runtime</strong> via the <code class="docutils literal notranslate"><span class="pre">__subclasshook__</span></code> method, which
verifies if the class implements the necessary methods for the protocol.</p>
</section>
<section id="how-to-implement-structural-subtyping">
<h4><a class="toc-backref" href="#id14" role="doc-backlink">How to Implement Structural Subtyping?</a><a class="headerlink" href="#how-to-implement-structural-subtyping" title="Link to this heading">#</a></h4>
<p>In languages supporting <strong><em>structural subtyping</em></strong>, subtype relationships are
established through the implementation of the required members, without the need
for explicit inheritance or interface implementation. This method focuses on the
actual implementation of the required properties and methods. More concretely,
if type <code class="docutils literal notranslate"><span class="pre">A</span></code> defines all the methods of type <code class="docutils literal notranslate"><span class="pre">B</span></code> (and <code class="docutils literal notranslate"><span class="pre">B</span></code> is usually a
<code class="docutils literal notranslate"><span class="pre">Protocol</span></code>), then <code class="docutils literal notranslate"><span class="pre">A</span></code> is a subtype of <code class="docutils literal notranslate"><span class="pre">B</span></code>, irrespective of their inheritance
relationship.</p>
<p>For pedagogical purposes, we can illustrate structural subtyping by implementing
it manually. Our <code class="docutils literal notranslate"><span class="pre">is_flyable</span></code> function checks if an object has a <code class="docutils literal notranslate"><span class="pre">fly</span></code>
attribute, and if that attribute is callable so we know that this attribute is a
method or function, and not a data attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">def</span> <span class="nf">is_flyable</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="linenos"> 2</span>    <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;fly&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">fly</span><span class="p">)</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">class</span> <span class="nc">Bird</span><span class="p">:</span>
<span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">fly</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 6</span>        <span class="k">return</span> <span class="s2">&quot;Bird flying&quot;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="k">class</span> <span class="nc">Airplane</span><span class="p">:</span>
<span class="linenos"> 9</span>    <span class="k">def</span> <span class="nf">fly</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">10</span>        <span class="k">return</span> <span class="s2">&quot;Airplane flying&quot;</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="k">class</span> <span class="nc">Car</span><span class="p">:</span>
<span class="linenos">13</span>    <span class="k">def</span> <span class="nf">drive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos">14</span>        <span class="k">return</span> <span class="s2">&quot;Car driving&quot;</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="nb">print</span><span class="p">(</span><span class="n">is_flyable</span><span class="p">(</span><span class="n">Bird</span><span class="p">()))</span>       <span class="c1"># True, because Bird implements a callable fly method</span>
<span class="linenos">17</span><span class="nb">print</span><span class="p">(</span><span class="n">is_flyable</span><span class="p">(</span><span class="n">Airplane</span><span class="p">()))</span>   <span class="c1"># True, Airplane also implements a callable fly method</span>
<span class="linenos">18</span><span class="nb">print</span><span class="p">(</span><span class="n">is_flyable</span><span class="p">(</span><span class="n">Car</span><span class="p">()))</span>        <span class="c1"># False, Car does not implement a callable fly method</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="n">objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">Bird</span><span class="p">(),</span> <span class="n">Airplane</span><span class="p">(),</span> <span class="n">Car</span><span class="p">()]</span>
<span class="linenos">21</span><span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
<span class="linenos">22</span>    <span class="k">if</span> <span class="n">is_flyable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="linenos">23</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can fly: </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">fly</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">24</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">25</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> cannot fly.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
True
False
Bird can fly: Bird flying
Airplane can fly: Airplane flying
Car cannot fly.
</pre></div>
</div>
</div>
</div>
<p>While manual checks like the one above illustrate the core idea of structural
subtyping, Python offers a more streamlined approach through the <code class="docutils literal notranslate"><span class="pre">typing</span></code>
module. By defining a <a class="reference external" href="https://peps.python.org/pep-0544/">protocol</a> via the
<code class="docutils literal notranslate"><span class="pre">Protocol</span></code> class, you can specify the required methods and properties for a
type,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Protocol</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">class</span> <span class="nc">Flyable</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="linenos"> 4</span>    <span class="k">def</span> <span class="nf">fly</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 5</span>        <span class="o">...</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="k">def</span> <span class="nf">can_we_fly</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Flyable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 8</span>    <span class="o">...</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">bird</span> <span class="o">=</span> <span class="n">Bird</span><span class="p">()</span>
<span class="linenos">11</span><span class="n">airplane</span> <span class="o">=</span> <span class="n">Airplane</span><span class="p">()</span>
<span class="linenos">12</span><span class="n">car</span> <span class="o">=</span> <span class="n">Car</span><span class="p">()</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">can_we_fly</span><span class="p">(</span><span class="n">bird</span><span class="p">)</span>       <span class="c1"># No error, Bird is a structural subtype of Flyable</span>
<span class="linenos">15</span><span class="n">can_we_fly</span><span class="p">(</span><span class="n">airplane</span><span class="p">)</span>   <span class="c1"># No error, Airplane is a structural subtype of Flyable</span>
<span class="linenos">16</span><span class="n">can_we_fly</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>        <span class="c1"># Error, Car is not a structural subtype of Flyable</span>
</pre></div>
</div>
</div>
</div>
<p>Here, both <code class="docutils literal notranslate"><span class="pre">Bird</span></code> and <code class="docutils literal notranslate"><span class="pre">Airplane</span></code> are considered structural subtypes of the
<code class="docutils literal notranslate"><span class="pre">Flyable</span></code> protocol because they implement the required <code class="docutils literal notranslate"><span class="pre">fly</span></code> method, even though
they donâ€™t explicitly inherit from <code class="docutils literal notranslate"><span class="pre">Flyable</span></code>. The <code class="docutils literal notranslate"><span class="pre">Car</span></code> class, on the other
hand, does not implement the <code class="docutils literal notranslate"><span class="pre">fly</span></code> method and is not considered a structural
subtype of <code class="docutils literal notranslate"><span class="pre">Flyable</span></code>.</p>
<p>It is worth noting that <code class="docutils literal notranslate"><span class="pre">mypy</span></code> is a static type checker, and hence if you run
<code class="docutils literal notranslate"><span class="pre">mypy</span></code> on the above code, the code is checked at <strong>compile time</strong> to ensure that
the <code class="docutils literal notranslate"><span class="pre">Bird</span></code> and <code class="docutils literal notranslate"><span class="pre">Airplane</span></code> classes are structural subtypes of the <code class="docutils literal notranslate"><span class="pre">Flyable</span></code>
protocol and that the <code class="docutils literal notranslate"><span class="pre">Car</span></code> class is not.</p>
<p>If you want to ensure that the check is done at runtime with <code class="docutils literal notranslate"><span class="pre">isinstance</span></code>, you
can use the decorator <code class="docutils literal notranslate"><span class="pre">runtime_checkable</span></code> to enable runtime instance
checks<a class="footnote-reference brackets" href="#runtime-checkable" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> (you cannot call <code class="docutils literal notranslate"><span class="pre">isinstance</span></code> on <code class="docutils literal notranslate"><span class="pre">Flyable</span></code> without
this decorator):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Protocol</span><span class="p">,</span> <span class="n">runtime_checkable</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="nd">@runtime_checkable</span>
<span class="linenos"> 4</span><span class="k">class</span> <span class="nc">Flyable</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="linenos"> 5</span>    <span class="k">def</span> <span class="nf">fly</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="linenos"> 6</span>        <span class="o">...</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">bird</span><span class="p">,</span> <span class="n">Flyable</span><span class="p">))</span>        <span class="c1"># True, Bird is a structural subtype of Flyable</span>
<span class="linenos"> 9</span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">airplane</span><span class="p">,</span> <span class="n">Flyable</span><span class="p">))</span>    <span class="c1"># True, Airplane is a structural subtype of Flyable</span>
<span class="linenos">10</span><span class="nb">print</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">car</span><span class="p">,</span> <span class="n">Flyable</span><span class="p">))</span>         <span class="c1"># False, Car is not a structural subtype of Flyable</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
True
False
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="pros-and-cons-of-nominal-and-structural-subtyping">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Pros and Cons of Nominal and Structural Subtyping</a><a class="headerlink" href="#pros-and-cons-of-nominal-and-structural-subtyping" title="Link to this heading">#</a></h3>
<p>In the nominal subtyping example, the subtype relationship is established
through explicit class inheritance. In the structural subtyping example, the
subtype relationship is based on the implementation of a specific interface
(defined by a <code class="docutils literal notranslate"><span class="pre">Protocol</span></code>), regardless of the inheritance relationship.</p>
<p>In the context of structural subtyping, a <em>nuanced</em> issue arises from the
application of the Liskov Substitution Principle (LSP). The LSP <em>asserts that
objects of a superclass should be replaceable with objects of a subclass without
affecting the correctness of the program</em>. Structural subtyping, however,
<em>evaluates</em> type compatibility based on the <em>presence and signature of methods</em>,
<em>not</em> on the <strong>inherent relationship</strong> or <strong>semantic compatibility</strong> between the
types. This leads to scenarios where a class <em>might</em> unintentionally become a
subtype of another by merely implementing the <strong>same</strong> method signatures,
potentially violating the LSP due to semantic discrepancies.</p>
<p>Consider the same example from nominal subtyping, but with an added
<code class="docutils literal notranslate"><span class="pre">__subclasshook__</span></code> method to the <code class="docutils literal notranslate"><span class="pre">Animal</span></code> class. This method is used to check if
a class is a structural subtype of <code class="docutils literal notranslate"><span class="pre">Animal</span></code> by checking if it implements the
<code class="docutils literal notranslate"><span class="pre">describe</span></code> and <code class="docutils literal notranslate"><span class="pre">make_sound</span></code> methods.</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>def <span class="ge">_check_</span>methods(C: Type, *methods: str) -&gt; bool:
<span class="linenos"> 2</span>    mro = C.__mro__
<span class="linenos"> 3</span>    for method in methods:
<span class="linenos"> 4</span>        for B in mro:
<span class="linenos"> 5</span>            if method in B.__dict__:
<span class="linenos"> 6</span>                if B.__dict__[method] is None:
<span class="linenos"> 7</span>                    return NotImplemented
<span class="linenos"> 8</span>                break
<span class="linenos"> 9</span>        else:
<span class="linenos">10</span>            return NotImplemented
<span class="linenos">11</span>    return True
<span class="linenos">12</span>
<span class="linenos">13</span>class Animal:
<span class="hll"><span class="linenos">14</span>    def describe(self) -&gt; str:
</span><span class="linenos">15</span>        return str(self.__class__.__name__)
<span class="linenos">16</span>
<span class="hll"><span class="linenos">17</span>    def make_sound(self) -&gt; str:
</span><span class="linenos">18</span>        return &quot;Generic Animal Sound!&quot;
<span class="linenos">19</span>
<span class="linenos">20</span>    <span class="ni">@classmethod</span>
<span class="linenos">21</span>    def <span class="gs">__subclasshook__</span>(cls: Type[Animal], C: Type) -&gt; bool:
<span class="linenos">22</span>        if cls is Animal:
<span class="linenos">23</span>            return <span class="ge">_check_</span>methods(C, &quot;describe&quot;, &quot;make_sound&quot;)
<span class="linenos">24</span>        return NotImplemented
<span class="linenos">25</span>
<span class="linenos">26</span>class Dog(Animal):
<span class="linenos">27</span>    def make_sound(self) -&gt; str:
<span class="linenos">28</span>        return &quot;Woof!&quot;
<span class="linenos">29</span>
<span class="linenos">30</span>    def fetch(self) -&gt; str:
<span class="linenos">31</span>        return &quot;Happily fetching balls!&quot;
<span class="linenos">32</span>
<span class="linenos">33</span>
<span class="linenos">34</span>class Cat(Animal):
<span class="linenos">35</span>    def make_sound(self) -&gt; str:
<span class="linenos">36</span>        return &quot;Meow&quot;
<span class="linenos">37</span>
<span class="linenos">38</span>    def how_many_lives(self) -&gt; str:
<span class="linenos">39</span>        return &quot;I have 9 lives!&quot;
<span class="linenos">40</span>
<span class="linenos">41</span>class Robot:
<span class="hll"><span class="linenos">42</span>    def describe(self) -&gt; str:
</span><span class="linenos">43</span>        return str(self.__class__.__name__)
<span class="linenos">44</span>
<span class="hll"><span class="linenos">45</span>    def make_sound(self) -&gt; str:
</span><span class="linenos">46</span>        return &quot;Generic Robot Sound!&quot;
</pre></div>
</div>
<p>In this code, <code class="docutils literal notranslate"><span class="pre">Robot</span></code> implements the <code class="docutils literal notranslate"><span class="pre">make_sound</span></code> method, which according to the
<code class="docutils literal notranslate"><span class="pre">__subclasshook__</span></code> in <code class="docutils literal notranslate"><span class="pre">Animal</span></code>, qualifies it as a subtype of <code class="docutils literal notranslate"><span class="pre">Animal</span></code> from a
structural subtyping perspective. However, from a semantic standpoint,
classifying a <code class="docutils literal notranslate"><span class="pre">Robot</span></code> as a subtype of <code class="docutils literal notranslate"><span class="pre">Animal</span></code> is incorrect because they belong
to fundamentally different categories of entities.</p>
<p>In practice, this can be avoided by adhering to good design patterns for your
type protocols or interfaces. Golang is a famous language that relies almost
exclusively on structural subtyping, hereâ€™s a good
<a class="reference external" href="https://appmaster.io/blog/interface-implementation-go">post</a> that summarizes
some of thees rules.</p>
</section>
</section>
<section id="inclusive-vs-coercive-implementations">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">Inclusive vs. Coercive Implementations</a><a class="headerlink" href="#inclusive-vs-coercive-implementations" title="Link to this heading">#</a></h2>
<p>While nominal and structural subtyping focus on <em>how</em> type relationships are
defined, <strong>inclusive</strong> and <strong>coercive</strong> implementations concern themselves with
<em>what happens</em> when types <strong>interact</strong> in a program, specifically how values of
one type are treated or converted to another type within the subtype
relationship<a class="footnote-reference brackets" href="#subtype-schemes-wikipedia" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
<section id="inclusive-implementations">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Inclusive Implementations</a><a class="headerlink" href="#inclusive-implementations" title="Link to this heading">#</a></h3>
<p>The <strong>basic idea</strong> of <em>inclusive implementations</em> is that the internal
representation of a value from a subtype is compatible with that of its
supertype. This means that the value itself doesnâ€™t need to change or be
converted when treated as a value of the supertype.</p>
<p>Think of this as direct <strong>â€œplug-and-playâ€</strong>. A subtype is a special case of the
supertype and can directly be used in any context where the supertype is
expected. No transformation or special handling is needed; the system inherently
understands that the subtype fits because its representation <strong>includes all
necessary aspects</strong> of the supertype.</p>
<p>In other words, if you have a subtype <span class="math notranslate nohighlight">\(\mathcal{A}\)</span> and a supertype
<span class="math notranslate nohighlight">\(\mathcal{B}\)</span>, any value that belongs to <span class="math notranslate nohighlight">\(\mathcal{A}\)</span> is also valid as a value
of <span class="math notranslate nohighlight">\(\mathcal{B}\)</span>. The representation of the value in <span class="math notranslate nohighlight">\(\mathcal{A}\)</span> is sufficient
to represent it in <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> as well.</p>
<div class="proof example admonition" id="type-theory-01-subtypes-example-inclusive-impl-oop">
<p class="admonition-title"><span class="caption-number">Example 5 </span> (Inclusive Implementations in Object-Oriented Languages)</p>
<section class="example-content" id="proof-content">
<p>Consider a class hierarchy where <code class="docutils literal notranslate"><span class="pre">Dog</span></code> extends <code class="docutils literal notranslate"><span class="pre">Animal</span></code>. A <code class="docutils literal notranslate"><span class="pre">Dog</span></code> object has all
the characteristics (fields, methods) of an <code class="docutils literal notranslate"><span class="pre">Animal</span></code> and possibly more. When you
treat a <code class="docutils literal notranslate"><span class="pre">Dog</span></code> object as an <code class="docutils literal notranslate"><span class="pre">Animal</span></code> (for example, passing it to a function that
expects an <code class="docutils literal notranslate"><span class="pre">Animal</span></code>), no conversion is needed - the <code class="docutils literal notranslate"><span class="pre">Dog</span></code> object â€˜fitsâ€™ into the
<code class="docutils literal notranslate"><span class="pre">Animal</span></code> type because it already includes all aspects of an <code class="docutils literal notranslate"><span class="pre">Animal</span></code>. This very
much sounds like the nominal subtyping we discussed earlier.</p>
</section>
</div></section>
<section id="coercive-implementations">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Coercive Implementations</a><a class="headerlink" href="#coercive-implementations" title="Link to this heading">#</a></h3>
<p>On the other hand, coercive implementations involve automatically converting a
value from one type to another when necessary. This conversion is typically
needed when the internal representations of the types are different. Imagine
this as needing an â€œadapterâ€ to make one type fit into the context of another.
The system recognizes that while the two types are not the same, thereâ€™s a known
way to convert from one to the other so that interactions can proceed smoothly.</p>
<p>To formalize the concept of coercive implementations in the context of subtypes
and supertypes with mathematical logic, we consider two types, <span class="math notranslate nohighlight">\(\mathcal{A}\)</span> and
<span class="math notranslate nohighlight">\(\mathcal{B}\)</span>, not necessary subtype of each other. The coercive implementation
implies that values of type <span class="math notranslate nohighlight">\(\mathcal{A}\)</span> may need to be converted to type
<span class="math notranslate nohighlight">\(\mathcal{B}\)</span> to be treated as values of <span class="math notranslate nohighlight">\(\mathcal{B}\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(\mathcal{A}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> be two types within a type system. We define
a coercive conversion process as a function <span class="math notranslate nohighlight">\(f\)</span> that maps values from
<span class="math notranslate nohighlight">\(\mathcal{A}\)</span> to <span class="math notranslate nohighlight">\(\mathcal{B}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
f: \mathcal{A} \rightarrow \mathcal{B}
\]</div>
<p>This function <span class="math notranslate nohighlight">\(f\)</span> takes a value <span class="math notranslate nohighlight">\(\mathcal{V}_{\mathcal{A}}\)</span> of type
<span class="math notranslate nohighlight">\(\mathcal{A}\)</span> and converts it into a value <span class="math notranslate nohighlight">\(\mathcal{V}_{\mathcal{B}}\)</span> of type
<span class="math notranslate nohighlight">\(\mathcal{B}\)</span>, such that:</p>
<div class="math notranslate nohighlight">
\[
\forall \mathcal{V}_{\mathcal{A}} \in \mathcal{A}, \exists \mathcal{V}_{\mathcal{B}} \in \mathcal{B} : \mathcal{V}_{\mathcal{B}} = f(\mathcal{V}_{\mathcal{A}})
\]</div>
<div class="proof example admonition" id="type-theory-01-subtypes-example-coercive-impl-primitive-types">
<p class="admonition-title"><span class="caption-number">Example 6 </span> (Coercive and Primitive Types)</p>
<section class="example-content" id="proof-content">
<p>A common example is numeric types, like integers and floating-point numbers. In
many languages, an integer can be used where a floating-point number is
expected. The integer (type <code class="docutils literal notranslate"><span class="pre">A</span></code>) is automatically converted (coerced) into a
floating-point number (type <code class="docutils literal notranslate"><span class="pre">B</span></code>). For instance, in a language like Python, if
you have a function that expects a float but you pass an integer, the integer
will be automatically converted to a float.</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gh"># Integer (type A)</span>
<span class="linenos">2</span>int_value = 5
<span class="linenos">3</span>
<span class="linenos">4</span><span class="gh"># Floating-point number (type B)</span>
<span class="linenos">5</span>float_value = 2.5
<span class="linenos">6</span>
<span class="linenos">7</span><span class="gh"># Adding an integer to a floating-point number</span>
<span class="linenos">8</span>result = int_value + float_value # 7.5
</pre></div>
</div>
<p>Even though <code class="docutils literal notranslate"><span class="pre">int_value</span></code> is an integer and <code class="docutils literal notranslate"><span class="pre">float_value</span></code> is a float, the
programming language automatically converts <code class="docutils literal notranslate"><span class="pre">int_value</span></code> to a float during the
addition operation. This is coercive implementation: the integer is
automatically converted to a float (a related but different type) to make the
operation possible.</p>
<p>In this context:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{A}\)</span> corresponds to the type <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{B}\)</span> corresponds to the type <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p></li>
<li><p>The function <span class="math notranslate nohighlight">\(f\)</span> represents the implicit conversion process that Python
performs to convert <code class="docutils literal notranslate"><span class="pre">int</span></code> to <code class="docutils literal notranslate"><span class="pre">float</span></code> before performing the addition.</p></li>
</ul>
<p>So, when <code class="docutils literal notranslate"><span class="pre">int_value</span></code> (of type <code class="docutils literal notranslate"><span class="pre">int</span></code>, or <span class="math notranslate nohighlight">\(\mathcal{A}\)</span>) and <code class="docutils literal notranslate"><span class="pre">float_value</span></code> (of
type <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <span class="math notranslate nohighlight">\(\mathcal{B}\)</span>) are added, Python implicitly applies the
conversion function <span class="math notranslate nohighlight">\(f\)</span> to <code class="docutils literal notranslate"><span class="pre">int_value</span></code> to convert it into a <code class="docutils literal notranslate"><span class="pre">float</span></code> (type
<span class="math notranslate nohighlight">\(\mathcal{B}\)</span>) before the addition. This can be thought of as:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{V}_{\mathcal{A}} = \text{int_value}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{V}_{\mathcal{B}} = f(\text{int_value}) = \text{float_value}\)</span></p></li>
</ul>
<p>Here, <span class="math notranslate nohighlight">\(f(\text{int_value})\)</span> effectively â€œcoercesâ€ or converts the integer value
to a floating-point value, ensuring that the addition operation occurs between
two values of the same type (<span class="math notranslate nohighlight">\(\mathcal{B}\)</span>, or <code class="docutils literal notranslate"><span class="pre">float</span></code>). The result of this
operation is a <code class="docutils literal notranslate"><span class="pre">float</span></code>, demonstrating how the coercive conversion aligns with
the formalism.</p>
</section>
</div></section>
</section>
<section id="references-and-further-readings">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">References and Further Readings</a><a class="headerlink" href="#references-and-further-readings" title="Link to this heading">#</a></h2>
<div class="seealso admonition">
<p class="admonition-title">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://mypy.readthedocs.io/en/stable/protocols.html">mypy - Protocols</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Subtyping#Subtyping_schemes">Subtyping schemes - Wikipedia</a></p></li>
<li><p><a class="reference external" href="https://medium.com/&#64;thejameskyle/type-systems-structural-vs-nominal-typing-explained-56511dd969f4">Type Systems: Structural vs. Nominal Typing Explained - Medium</a></p></li>
<li><p><a class="reference external" href="https://wiki.edunitas.com/IT/en/114-10/Subtyping_4238_eduNitas.html">Subtyping - eduNitas</a></p></li>
<li><p><a class="reference external" href="https://peps.python.org/pep-0544/">PEP 544 â€“ Protocols: Structural subtyping (static duck typing)</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Nominal_type_system">Nominal Type System - Wikipedia</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Structural_type_system">Structural Type System - Wikipedia</a></p></li>
</ul>
</div>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="subtype-wikipedia" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Subtyping">Subtyping - Wikipedia</a></p>
</aside>
<aside class="footnote brackets" id="subtype-subsumption-wikipedia" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Subtyping#Subsumption">Subtype Subsumption - Wikipedia</a></p>
</aside>
<aside class="footnote brackets" id="runtime-checkable" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://mypy.readthedocs.io/en/stable/protocols.html#using-isinstance-with-protocols">Using isinstance() with protocols</a></p>
</aside>
<aside class="footnote brackets" id="subtype-schemes-wikipedia" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Subtyping#Subtyping_schemes">Subtyping Schemes - Wikipedia</a></p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./computer_science/type_theory"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Type Theory, A Very Rudimentary Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="02-type-safety.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Type Safety</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-are-sets">Types are Sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nominal-vs-structural-subtyping">Nominal vs. Structural Subtyping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nominal-subtyping-class-hierarchy-determines-subtypes">Nominal Subtyping - Class Hierarchy Determines Subtypes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-nominal-subtyping">What is Nominal Subtyping?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-nominal-subtyping">Why Nominal Subtyping?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-implement-nominal-subtyping">How to Implement Nominal Subtyping?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structural-subtyping">Structural Subtyping</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-structural-subtyping">What is Structural Subtyping?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-structural-subtyping">Why Structural Subtyping?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-implement-structural-subtyping">How to Implement Structural Subtyping?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pros-and-cons-of-nominal-and-structural-subtyping">Pros and Cons of Nominal and Structural Subtyping</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusive-vs-coercive-implementations">Inclusive vs. Coercive Implementations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusive-implementations">Inclusive Implementations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coercive-implementations">Coercive Implementations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references-and-further-readings">References and Further Readings</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gao Hongnan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>