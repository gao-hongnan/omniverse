
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Stage 5.2. Metric Selection &#8212; Omniverse</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=bb35926c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-MYW5YKC2WF"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MYW5YKC2WF');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MYW5YKC2WF');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'operations/machine_learning_lifecycle/05_model_development_selection_and_training/052_metric_selection';</script>
    <link rel="canonical" href="https://www.gaohongnan.com/operations/machine_learning_lifecycle/05_model_development_selection_and_training/052_metric_selection.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Stage 5.3. Experiment Tracking And Versioning" href="053_experiment_tracking.html" />
    <link rel="prev" title="Stage 5.1. Model Selection" href="051_model_selection.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Omniverse - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Omniverse - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    🌌 Omniverse: A Journey Through Knowledge
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Notations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../notations/machine_learning.html">Machine Learning Notations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Influential Ideas and Papers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../influential/generative_pretrained_transformer/01_intro.html">Generative Pre-trained Transformers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../influential/generative_pretrained_transformer/02_notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../influential/generative_pretrained_transformer/03_concept.html">The Concept of Generative Pre-trained Transformers (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../influential/generative_pretrained_transformer/04_implementation.html">The Implementation of Generative Pre-trained Transformers (GPT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../influential/generative_pretrained_transformer/05_adder.html">Training a Mini-GPT to Learn Two-Digit Addition</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../influential/low_rank_adaptation/01_intro.html">Low-Rank Adaptation Of Large Language Models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../influential/low_rank_adaptation/02_concept.html">Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../influential/low_rank_adaptation/03_implementation.html">Implementation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../influential/kmeans_clustering/01_intro.html">K-Means</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../influential/kmeans_clustering/02_concept.html">Concept: K-Means Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../influential/kmeans_clustering/03_implementation.html">Implementation: K-Means (Lloyd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../influential/kmeans_clustering/04_image_segmentation.html">Application: Image Compression and Segmentation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Playbook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../playbook/how_to_calculate_flops_in_transformer_based_models.html">How to Calculate the Number of FLOPs in Transformer Based Models?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../playbook/how_to_inspect_function_and_class_signatures.html">How to Inspect Function and Class Signatures in Python?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../playbook/why_cosine_annealing_warmup_stabilize_training.html">Why Does Cosine Annealing With Warmup Stabilize Training?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../playbook/why_softmax_preserves_order_translation_invariant_not_invariant_scaling.html">Softmax Preserves Order, Is Translation Invariant But Not Invariant Under Scaling.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../playbook/how_to_finetune_decoder_with_last_token_pooling.html">How To Fine-Tune Decoder-Only Models For Sequence Classification Using Last Token Pooling?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../playbook/how_to_finetune_decoder_with_cross_attention.html">How To Fine-Tune Decoder-Only Models For Sequence Classification With Cross-Attention?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../playbook/how_to_teacher_student_knowledge_distillation.html">How To Do Teacher-Student Knowledge Distillation?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Operations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../distributed/intro.html">Distributed Systems</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../distributed/01_notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../distributed/02_basics.html">Basics Of Distributed Data Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../distributed/03_how_to_setup_slurm_in_aws.html">How to Setup SLURM and ParallelCluster in AWS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../distributed/04_ablation.html">Ablations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../profiling/intro.html">Profiling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../profiling/01_synchronize.html">Synchronize CUDA To Time CUDA Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../profiling/02_timeit.html">Profiling Code With Timeit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../profiling/03_time_profiler.html">PyTorch’s Event And Profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../profiling/04_small_gpt_profile.html">Profile GPT Small Time And Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../profiling/05_memory_leak.html">CUDA Memory Allocations</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../00_intro.html">The Lifecycle of an AIOps System</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../01_problem_formulation.html">Stage 1. Problem Formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_project_scoping.html">Stage 2. Project Scoping And Framing The Problem</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../03_dataops_pipeline/03_dataops_pipeline.html">Stage 3. Data Pipeline (Data Engineering and DataOps)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../03_dataops_pipeline/031_data_source_and_format.html">Stage 3.1. Data Source and Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../03_dataops_pipeline/032_data_model_and_storage.html">Stage 3.2. Data Model and Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../03_dataops_pipeline/033_etl.html">Stage 3.3. Extract, Transform, Load (ETL)</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../04_mlops_data_pipeline.html">Stage 4. Data Extraction (MLOps), Data Analysis (Data Science), Data Preparation (Data Science)</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="05_ml_training_pipeline.html">Stage 5. Model Development and Training (MLOps)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="051_model_selection.html">Stage 5.1. Model Selection</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Stage 5.2. Metric Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="053_experiment_tracking.html">Stage 5.3. Experiment Tracking And Versioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="054_model_testing.html">Stage 5.4. Model Testing</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../06_model_evaluation.html">Stage 6. Model Evaluation (MLOps)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_model_validation_registry_and_pushing_model_to_production.html">Stage 7. Model Validation, Registry and Pushing Model to Production (MLOps)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_model_deployment_and_serving.html">Stage 8. Model Serving (MLOps)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09_model_monitoring.html">Stage 9. Model Monitoring (MLOps)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../010_continuous_integration_deployment_learning_and_training.html">Stage 10. Continuous Integration, Deployment, Learning and Training (DevOps, DataOps, MLOps)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../011_infrastructure_and_tooling_for_mlops.html">Stage 11. Infrastructure and Tooling for MLOps</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Software Engineering</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../software_engineering/config_management/concept.html">Configuration Management</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../software_engineering/config_management/01-pydra.html">Pydantic And Hydra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../software_engineering/config_management/02-state.html">State And Metadata Management</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../software_engineering/design_patterns/intro.html">Design Patterns</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../software_engineering/design_patterns/dependency-inversion-principle.html">Dependency Inversion Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../software_engineering/design_patterns/strategy.html">Strategy Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../software_engineering/design_patterns/registry.html">Registry Design Pattern</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../software_engineering/concurrency_parallelism_asynchronous/intro.html">Concurrency, Parallelism and Asynchronous Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../software_engineering/concurrency_parallelism_asynchronous/generator_yield.html">A Rudimentary Introduction to Generator and Yield in Python</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../computer_science/type_theory/intro.html">Type Theory, A Very Rudimentary Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../computer_science/type_theory/01-subtypes.html">Subtypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../computer_science/type_theory/02-type-safety.html">Type Safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../computer_science/type_theory/03-subsumption.html">Subsumption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../computer_science/type_theory/04-generics.html">Generics and Type Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../computer_science/type_theory/05-typevar-bound-constraints.html">Bound and Constraint in Generics and Type Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../computer_science/type_theory/06-invariance-covariance-contravariance.html">Invariance, Covariance and Contravariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../computer_science/type_theory/07-pep-3124-overloading.html">Function Overloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../computer_science/type_theory/08-pep-661-sentinel-values.html">Sentinel Types</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Structures and Algorithms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../dsa/complexity_analysis/intro.html">Complexity Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../dsa/complexity_analysis/master_theorem.html">Master Theorem </a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../dsa/stack/intro.html">Stack</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../dsa/stack/concept.html">Concept</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../dsa/searching_algorithms/linear_search/intro.html">Linear Search</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../dsa/searching_algorithms/linear_search/concept.html">Concept</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../dsa/searching_algorithms/binary_search/intro.html">Binary Search</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../dsa/searching_algorithms/binary_search/concept.html">Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dsa/searching_algorithms/binary_search/problems/875-koko-eating-bananas.html">Koko Eating Bananas</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Algebra</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../linear_algebra/01_preliminaries/intro.html">Preliminaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../linear_algebra/01_preliminaries/01-fields.html">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linear_algebra/01_preliminaries/02-systems-of-linear-equations.html">Systems of Linear Equations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../linear_algebra/02_vectors/intro.html">Vectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../linear_algebra/02_vectors/01-vector-definition.html">Vector and Its Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linear_algebra/02_vectors/02-vector-operation.html">Vector and Its Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linear_algebra/02_vectors/03-vector-norm.html">Vector Norm and Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../linear_algebra/02_vectors/04-vector-products.html">A First Look at Vector Products</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Probability Theory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../probability_theory/01_mathematical_preliminaries/intro.html">Chapter 1. Mathematical Preliminaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../probability_theory/01_mathematical_preliminaries/01_combinatorics.html">Permutations and Combinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../probability_theory/01_mathematical_preliminaries/02_calculus.html">Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../probability_theory/01_mathematical_preliminaries/03_contours.html">Contour Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../probability_theory/01_mathematical_preliminaries/exercises.html">Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References, Resources and Roadmap</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../citations.html">IEEE (Style) Citations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../api/reproducibility.html">API Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/gao-hongnan/omniverse/blob/main/omniverse/operations/machine_learning_lifecycle/05_model_development_selection_and_training/052_metric_selection.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/gao-hongnan/omniverse" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gao-hongnan/omniverse/issues/new?title=Issue%20on%20page%20%2Foperations/machine_learning_lifecycle/05_model_development_selection_and_training/052_metric_selection.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/operations/machine_learning_lifecycle/05_model_development_selection_and_training/052_metric_selection.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../../_sources/operations/machine_learning_lifecycle/05_model_development_selection_and_training/052_metric_selection.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Stage 5.2. Metric Selection</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metric-selection">Metric Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#classification">Classification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression">Regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering">Clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ranking-detection-pairwise-retrieval-and-other-metrics">Ranking, Detection, Pairwise, Retrieval And Other Metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-the-right-metric">Choosing The Right Metric</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-your-metrics-wisely">Choose Your Metrics Wisely</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#benefit-structure">Benefit Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibration">Calibration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-does-calibration-matter">Why Does Calibration Matter?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-models">Calibrating Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibration-and-evaluation-brier-auroc-combo">Calibration and Evaluation (Brier + AUROC combo)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="stage-5-2-metric-selection">
<h1>Stage 5.2. Metric Selection<a class="headerlink" href="#stage-5-2-metric-selection" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://twitter.com/gaohongnan"><img alt="Twitter Handle" src="https://img.shields.io/badge/Twitter-&#64;gaohongnan-blue?style=social&amp;logo=twitter" /></a>
<a class="reference external" href="https://linkedin.com/in/gao-hongnan"><img alt="LinkedIn Profile" src="https://img.shields.io/badge/&#64;gaohongnan-blue?style=social&amp;logo=linkedin" /></a>
<a class="reference external" href="https://github.com/gao-hongnan"><img alt="GitHub Profile" src="https://img.shields.io/badge/GitHub-gao--hongnan-lightgrey?style=social&amp;logo=github" /></a>
<img alt="Tag" src="https://img.shields.io/badge/Tag-Brain_Dump-red" />
<img alt="Tag" src="https://img.shields.io/badge/Level-Beginner-green" /></p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#metric-selection" id="id1">Metric Selection</a></p>
<ul>
<li><p><a class="reference internal" href="#classification" id="id2">Classification</a></p></li>
<li><p><a class="reference internal" href="#regression" id="id3">Regression</a></p></li>
<li><p><a class="reference internal" href="#clustering" id="id4">Clustering</a></p></li>
<li><p><a class="reference internal" href="#ranking-detection-pairwise-retrieval-and-other-metrics" id="id5">Ranking, Detection, Pairwise, Retrieval And Other Metrics</a></p></li>
<li><p><a class="reference internal" href="#choosing-the-right-metric" id="id6">Choosing The Right Metric</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#choose-your-metrics-wisely" id="id7">Choose Your Metrics Wisely</a></p></li>
<li><p><a class="reference internal" href="#benefit-structure" id="id8">Benefit Structure</a></p></li>
<li><p><a class="reference internal" href="#calibration" id="id9">Calibration</a></p>
<ul>
<li><p><a class="reference internal" href="#why-does-calibration-matter" id="id10">Why Does Calibration Matter?</a></p></li>
<li><p><a class="reference internal" href="#example" id="id11">Example</a></p></li>
<li><p><a class="reference internal" href="#calibrating-models" id="id12">Calibrating Models</a></p></li>
<li><p><a class="reference internal" href="#calibration-and-evaluation-brier-auroc-combo" id="id13">Calibration and Evaluation (Brier + AUROC combo)</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="metric-selection">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Metric Selection</a><a class="headerlink" href="#metric-selection" title="Link to this heading">#</a></h2>
<p>Before beginning model training, it’s crucial to define the metrics by which the
model’s performance will be evaluated. These metrics will guide the optimization
process and provide a quantitative measure of the model’s quality.</p>
<p>The appropriate metric depends on the type of machine learning task, the data,
and the specific requirements of the project:</p>
<section id="classification">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Classification</a><a class="headerlink" href="#classification" title="Link to this heading">#</a></h3>
<p>Here, we’re predicting categorical outcomes. Common metrics include Accuracy
(percentage of correct predictions), Precision (proportion of true positive
predictions out of all positive predictions), Recall (proportion of true
positive predictions out of all actual positives), F1-Score (harmonic mean of
precision and recall), and AUC-ROC (area under the Receiver Operating
Characteristic curve, representing the model’s ability to distinguish between
classes).</p>
</section>
<section id="regression">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Regression</a><a class="headerlink" href="#regression" title="Link to this heading">#</a></h3>
<p>In regression problems, we’re predicting continuous values. Metrics like Mean
Absolute Error (MAE), Mean Squared Error (MSE), Root Mean Squared Error (RMSE),
and R-squared are typically used.</p>
<p>MAE measures the average magnitude of errors in a set of predictions, without
considering their direction. MSE and RMSE are similar to MAE but amplify the
impact of large errors. R-squared (coefficient of determination) explains how
much of the dependent variable’s variation is explained by the independent
variable(s).</p>
</section>
<section id="clustering">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Clustering</a><a class="headerlink" href="#clustering" title="Link to this heading">#</a></h3>
<p>In clustering problems we typically see Adjusted Mutual Information Score (AMI),
Adjusted Rand Index (ARI), Completeness Score, Homogeneity Score, and Silhouette
Score. These metrics evaluate the quality of the clustering results by comparing
the predicted clusters to the true clusters.</p>
</section>
<section id="ranking-detection-pairwise-retrieval-and-other-metrics">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Ranking, Detection, Pairwise, Retrieval And Other Metrics</a><a class="headerlink" href="#ranking-detection-pairwise-retrieval-and-other-metrics" title="Link to this heading">#</a></h3>
<p>There are many many more different types of metrics, for a comprehensive list,
you can see
<a class="reference external" href="https://lightning.ai/docs/torchmetrics/stable/all-metrics.html">TorchMetrics</a>
or
<a class="reference external" href="https://scikit-learn.org/stable/modules/model_evaluation.html">Scikit-Learn</a>.</p>
</section>
<section id="choosing-the-right-metric">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Choosing The Right Metric</a><a class="headerlink" href="#choosing-the-right-metric" title="Link to this heading">#</a></h3>
<p>Remember that the choice of a metric should align with the business objective.
For instance, if false positives and false negatives have a different cost, you
might want to optimize for Precision or Recall rather than overall Accuracy.</p>
<p>When comparing different models, it’s important to use the same metric for a
fair comparison. If one model is optimized for Accuracy and another for
F1-Score, they might perform differently when evaluated using a single, common
metric.</p>
<p>It’s not uncommon to use multiple metrics to evaluate a model’s performance, as
they can each highlight different aspects of the model’s behavior. For instance,
in a binary classification problem, accuracy might not be a good metric if the
classes are imbalanced; precision and recall or the F1-score might be more
informative.</p>
</section>
</section>
<section id="choose-your-metrics-wisely">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Choose Your Metrics Wisely</a><a class="headerlink" href="#choose-your-metrics-wisely" title="Link to this heading">#</a></h2>
<p>If you choose a misleading metric, you might end up with a model that performs
well on paper but fails in practice simply because it reports a misleading and
optimistic performance whereas it is not doing well.</p>
<p>Consider a training dataset consisting of 1000 patients where we want to train a
classifier to “accurately” classify whether a patient has cancer (positive
class 1) or no cancer (negative class 0). The dataset is dichotimized by 950
benign patients and the remaining 50, cancerous.</p>
<p>The ZeroR classifier (baseline classification model) predicts only the majority
class. And in our case, the in-sample training set accuracy will be <span class="math notranslate nohighlight">\(0.95\%\)</span>
since it predicts all sample to be benign; for completeness, we also assume a
validation set with 1000 patients (990 benign and 10 cancerous), it follows that
our validation set’s accuracy will be <span class="math notranslate nohighlight">\(0.99\%\)</span>.</p>
<p>Euphoria is at all time high over this result, surprised that a baseline model
can perform so well, you then happily reported this result to your boss, and
gets fired immediately. You drown in tears and googled “Is accuracy a bad
metric?”, only to learn a valuable lesson: since the model you trained will
predict benign no matter the input, this means it completely missed out every
single cancerous patient even though you get a 99 percent accuracy.</p>
</section>
<section id="benefit-structure">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Benefit Structure</a><a class="headerlink" href="#benefit-structure" title="Link to this heading">#</a></h2>
<p>The “benefit structure” or “cost-benefit analysis” is an approach to model
evaluation that goes beyond standard metrics like accuracy, precision, and
recall. It involves assigning specific costs and benefits to different types of
errors and correct decisions the model makes, based on their real-world
implications. This analysis can be especially crucial in fields like healthcare,
where different types of errors can have drastically different consequences.</p>
<p>Let’s illustrate this with an example of cancer detection.</p>
<p>Suppose we are building a machine learning model to detect whether a patient has
cancer based on various diagnostic tests. The prediction can either be positive
(cancer detected) or negative (no cancer detected). However, these predictions
can either be correct or incorrect, leading to four possible outcomes:</p>
<ul class="simple">
<li><p><strong>True Positive (TP)</strong>: The model correctly identifies a cancer patient.</p></li>
<li><p><strong>True Negative (TN)</strong>: The model correctly identifies a healthy patient.</p></li>
<li><p><strong>False Positive (FP)</strong>: The model incorrectly identifies a healthy patient
as having cancer.</p></li>
<li><p><strong>False Negative (FN)</strong>: The model incorrectly identifies a cancer patient
as healthy.</p></li>
</ul>
<p>We can construct a table like this:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>-</p></th>
<th class="head"><p>Cancer (actual)</p></th>
<th class="head"><p>No Cancer (actual)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Cancer (predicted)</strong></p></td>
<td><p>TP (Benefit: early treatment, higher survival rate)</p></td>
<td><p>FP (Cost: unnecessary worry, further tests)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>No Cancer (predicted)</strong></p></td>
<td><p>FN (Cost: delayed treatment, lower survival rate)</p></td>
<td><p>TN (Benefit: peace of mind, no further tests)</p></td>
</tr>
</tbody>
</table>
</div>
<p>The benefits and costs associated with each outcome can be estimated:</p>
<ul class="simple">
<li><p><strong>True Positive (TP)</strong>: Early detection of cancer can lead to early
treatment, which significantly increases the survival rate. We might assign
a high benefit value here, say +100.</p></li>
<li><p><strong>True Negative (TN)</strong>: Correctly identifying a patient without cancer can
provide peace of mind and avoid unnecessary further tests. We might assign a
moderate benefit value here, say +10.</p></li>
<li><p><strong>False Positive (FP)</strong>: A false positive result can lead to unnecessary
worry and further tests for the patient. We could assign a moderate cost
value here, say -20.</p></li>
<li><p><strong>False Negative (FN)</strong>: A false negative is very harmful because it might
lead to delayed treatment, significantly decreasing the survival rate.
Therefore, we could assign a high cost value here, say -200.</p></li>
</ul>
<p>Using this benefit structure, we can evaluate the model not just on how often
it’s right or wrong, but also on the real-world impact of its predictions.</p>
<p>A model with a higher overall benefit score (i.e., a weighted sum of TP, TN, FP,
FN using the assigned benefit/cost values) would be preferred over one with
lower benefit score, even if the latter has higher accuracy.</p>
<p>In conclusion, benefit structure allows for a more nuanced evaluation of model
performance by considering the specific implications of each type of prediction
error. This type of analysis is particularly relevant in critical
decision-making contexts, such as medical diagnosis, credit scoring, or fraud
detection.</p>
</section>
<section id="calibration">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Calibration</a><a class="headerlink" href="#calibration" title="Link to this heading">#</a></h2>
<p>Calibration in the context of machine learning models refers to how well the
model’s predicted probabilities of outcomes match the actual outcomes’
frequencies in the real world. A well-calibrated model means that if the model
predicts an event with a probability of <span class="math notranslate nohighlight">\(p\)</span>, that event should indeed occur
approximately <span class="math notranslate nohighlight">\(p\)</span> percent of the time. For example, if a model predicts that
there’s a <span class="math notranslate nohighlight">\(70 \%\)</span> chance of rain tomorrow, then, ideally, it should rain 70 out
of 100 similar days with that prediction.</p>
<div class="seealso admonition">
<p class="admonition-title">See Also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.unofficialgoogledatascience.com/2021/04/why-model-calibration-matters-and-how.html">Why model calibration matters and how to achieve it</a>.</p></li>
</ul>
</div>
<section id="why-does-calibration-matter">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Why Does Calibration Matter?</a><a class="headerlink" href="#why-does-calibration-matter" title="Link to this heading">#</a></h3>
<p>The output of classification models can often be interpreted as the probability
that a given instance belongs to the positive class. For example, in binary
classification, a model might predict a value of 0.7 for a certain instance,
which can be interpreted as a 70% probability that this instance belongs to the
positive class.</p>
<p>However, these predicted probabilities are not always accurate. For example, a
model might predict a probability of 70% for a set of instances, but only 60% of
them actually belong to the positive class. This discrepancy between the
predicted probabilities and the true probabilities is a sign that the model is
not well-calibrated.</p>
<p>A well-calibrated model is one where, for all instances where it predicts a
probability of P, the proportion of those instances that are positive is
actually P. For example, if we gather all instances where the model predicts a
70% probability, 70% of those instances should indeed be positive. Calibration
is particularly important in cases where the predicted probabilities are used to
make decisions that depend not just on the class labels, but also on the
certainty of the prediction.</p>
</section>
<section id="example">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Example</a><a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<p>Let’s consider a model that predicts whether a patient has a certain disease
(the positive class) or not (the negative class) based on some diagnostic tests.
Let’s assume we have a set of 1000 patients and the model makes predictions on
this set.</p>
<p>We could compile the model’s predictions and the actual outcomes into a table
like this:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Predicted Probability</p></th>
<th class="head"><p>Number of Predictions</p></th>
<th class="head"><p>Actual Positives</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.1-0.2</p></td>
<td><p>200</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-odd"><td><p>0.2-0.3</p></td>
<td><p>180</p></td>
<td><p>50</p></td>
</tr>
<tr class="row-even"><td><p>0.3-0.4</p></td>
<td><p>150</p></td>
<td><p>60</p></td>
</tr>
<tr class="row-odd"><td><p>0.4-0.5</p></td>
<td><p>120</p></td>
<td><p>65</p></td>
</tr>
<tr class="row-even"><td><p>0.5-0.6</p></td>
<td><p>100</p></td>
<td><p>70</p></td>
</tr>
<tr class="row-odd"><td><p>0.6-0.7</p></td>
<td><p>90</p></td>
<td><p>65</p></td>
</tr>
<tr class="row-even"><td><p>0.7-0.8</p></td>
<td><p>80</p></td>
<td><p>65</p></td>
</tr>
<tr class="row-odd"><td><p>0.8-0.9</p></td>
<td><p>50</p></td>
<td><p>45</p></td>
</tr>
<tr class="row-even"><td><p>0.9-1.0</p></td>
<td><p>30</p></td>
<td><p>30</p></td>
</tr>
</tbody>
</table>
</div>
<p>In this table, we’ve binned the predictions into ranges like 0.1-0.2, 0.2-0.3,
etc. Then we count the number of predictions in each bin and the number of
actual positives in each bin.</p>
<p>Ideally, the proportion of actual positives in each bin should match the
predicted probability. For example, in the 0.3-0.4 bin, the model predicts a
probability of 30% to 40%, and the actual proportion of positives is 60/150 =
40%, which is well within the range.</p>
<p>But if we look at the 0.7-0.8 bin, the model predicts a 70% to 80% probability,
but the actual proportion of positives is 65/80 = 81.25%. This is a sign that
the model is not well-calibrated for this range of probabilities, as the actual
positive rate is higher than the predicted probability.</p>
<p>In practice, we often visualize this data with a calibration plot, where the
x-axis represents the predicted probabilities and the y-axis represents the
actual positive rates. A well-calibrated model would lie along the line y = x,
while deviations from this line indicate miscalibration.</p>
</section>
<section id="calibrating-models">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Calibrating Models</a><a class="headerlink" href="#calibrating-models" title="Link to this heading">#</a></h3>
<p>There are several methods to calibrate a model after it has been trained. One of
the most popular methods is Platt Scaling, which fits a logistic regression
model to the model’s scores. This logistic regression model can adjust the
predicted probabilities to make them more accurate. Another popular method is
Isotonic Regression, which fits a piecewise-constant non-decreasing function to
the model’s scores.</p>
<div class="seealso admonition">
<p class="admonition-title">See Also</p>
<ul class="simple">
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/calibration.html">1.16. Probability calibration (Scikit-Learn)</a></p></li>
</ul>
</div>
</section>
<section id="calibration-and-evaluation-brier-auroc-combo">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Calibration and Evaluation (Brier + AUROC combo)</a><a class="headerlink" href="#calibration-and-evaluation-brier-auroc-combo" title="Link to this heading">#</a></h3>
<p>Once a model is calibrated, we need a way to evaluate how well-calibrated it is.
This can be done using calibration plots, also known as reliability diagrams. In
a calibration plot, the x-axis represents the predicted probabilities and the
y-axis represents the proportion of instances that are positive. A
well-calibrated model will have its calibration plot close to the diagonal.</p>
<p>Another common way to evaluate calibration is using the Brier score. The Brier
score is a metric that combines calibration and refinement. The Brier score is
given by:</p>
<div class="math notranslate nohighlight">
\[
BS = \frac{1}{N}\sum_{t=1}^{N}(f_t-o_t)^2
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> is the total number of instances,</p></li>
<li><p><span class="math notranslate nohighlight">\(f_t\)</span> is the predicted probability for instance <span class="math notranslate nohighlight">\(t\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(o_t\)</span> is the true outcome for instance <span class="math notranslate nohighlight">\(t\)</span> (1 for positive and 0 for
negative).</p></li>
</ul>
<p>The Brier score ranges from 0 for a perfect model to 1 for a constantly wrong
model. However, the Brier score alone is not sufficient to evaluate a model, as
it does not account for the model’s ability to discriminate between classes. For
this reason, it is often used in combination with the AUROC (Area Under the
Receiver Operating Characteristic curve) metric.</p>
<p>While the AUROC measures how well the model can distinguish between classes, it
does not take into account the accuracy of the predicted probabilities. Thus,
using the Brier score and the AUROC together can provide a more complete
evaluation of a model’s performance. By optimizing these two metrics
simultaneously, we can obtain a model that not only discriminates well between
classes, but also provides accurate predicted probabilities.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://lightning.ai/docs/torchmetrics/stable/all-metrics.html">TorchMetrics</a></p></li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/model_evaluation.html">Scikit-Learn</a>.</p></li>
<li><p><a class="reference external" href="https://sebastianraschka.com/pdf/manuscripts/model-eval.pdf">Model Evaluation, Model Selection, and Algorithm Selection in Machine Learning</a></p></li>
<li><p>Huyen, Chip. “Chapter 6. Model Development and Offline Evaluation.” In
Designing Machine Learning Systems: An Iterative Process for
Production-Ready Applications, O’Reilly Media, Inc., 2022.</p></li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/calibration.html">Scikit-Learn: Probability Calibration</a></p></li>
<li><p><a class="reference external" href="https://www.unofficialgoogledatascience.com/2021/04/why-model-calibration-matters-and-how.html">Google: Why model calibration matters and how?</a></p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./operations/machine_learning_lifecycle/05_model_development_selection_and_training"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="051_model_selection.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Stage 5.1. Model Selection</p>
      </div>
    </a>
    <a class="right-next"
       href="053_experiment_tracking.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Stage 5.3. Experiment Tracking And Versioning</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metric-selection">Metric Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#classification">Classification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression">Regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering">Clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ranking-detection-pairwise-retrieval-and-other-metrics">Ranking, Detection, Pairwise, Retrieval And Other Metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-the-right-metric">Choosing The Right Metric</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-your-metrics-wisely">Choose Your Metrics Wisely</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#benefit-structure">Benefit Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibration">Calibration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-does-calibration-matter">Why Does Calibration Matter?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-models">Calibrating Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibration-and-evaluation-brier-auroc-combo">Calibration and Evaluation (Brier + AUROC combo)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gao Hongnan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>